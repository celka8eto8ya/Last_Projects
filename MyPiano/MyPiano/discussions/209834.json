[
  {
    "Id": "432914",
    "ThreadId": "209834",
    "Html": "<p>i have use a Naudio.dll to capture vioce from sound card. And i use a NEtworkStream to transfer the captured stream via network.</p>\r\n<p>The recived stream am saves to wav file on remote PC (Client Side). I have only one question....</p>\r\n<p>How i Can play recived stream from a network to default sound output using Naudio.dll(http://naudio.codeplex.com/)in online mode?</p>\r\n<p>am writing in Visual Basic. Net (2008). Help me please to do so.</p>\r\n<p>the Server Source Code:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:green\">'Its need to Capture Data</span>\r\n<span style=\"color:blue\">Imports</span> Microsoft.DirectX.DirectSound\r\n<span style=\"color:blue\">Imports</span> NAudio\r\n<span style=\"color:blue\">Imports</span> Microsoft.VisualBasic.Devices\r\n<span style=\"color:blue\">Imports</span> System\r\n<span style=\"color:blue\">Imports</span> System.IO\r\n<span style=\"color:green\">'End Capture Data</span>\r\n<span style=\"color:green\">'Its NEED for Transform Stream via network</span>\r\n<span style=\"color:blue\">Imports</span> System.Net\r\n<span style=\"color:blue\">Imports</span> System.Net.Sockets\r\n<span style=\"color:blue\">Imports</span> System.Text\r\n<span style=\"color:blue\">Imports</span> Microsoft.VisualBasic\r\n<span style=\"color:green\">'END TransFormVIA Network</span>\r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> SOPROForm\r\n    <span style=\"color:blue\">Public</span> StreamSocket <span style=\"color:blue\">As</span> NetworkStream\r\n    <span style=\"color:blue\">Public</span> acepted <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span> <span style=\"color:green\">'When Accepted</span>\r\n    <span style=\"color:blue\">Public</span> TCPSvr <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> TcpListener(3344) <span style=\"color:green\">'Listener</span>\r\n    <span style=\"color:blue\">Public</span> TCPClient <span style=\"color:blue\">As</span> TcpClient\r\n    <span style=\"color:blue\">Public</span> LittleFIleName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Application.ProductName.ToString <span style=\"color:green\">'Little File Name</span>\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">WithEvents</span> StreamWavein <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> NAudio.Wave.WaveIn <span style=\"color:green\">'Wave in Stream Generates by Naudio</span>\r\n    <span style=\"color:blue\">Public</span> waveInFormat <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> NAudio.Wave.WaveFormat(16000, 1) <span style=\"color:green\">' Wave In format</span>\r\n    <span style=\"color:blue\">Public</span> Writer <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> Wave.WaveFileWriter(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Waweout.waveout&quot;</span>, waveInFormat) <span style=\"color:green\">'Wave Stream Writer</span>\r\n    <span style=\"color:blue\">Public</span> OperatorName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> <span style=\"color:green\">' Operator Name</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Form1_Load(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> <span style=\"color:blue\">MyBase</span>.Load\r\n\r\n        TCPSvr.Start()\r\n        NotifyIcon1.Icon = <span style=\"color:blue\">New</span> System.Drawing.Icon(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\LAME\\NotRec.ico&quot;</span>)\r\n        BackgroundWorker1.RunWorkerAsync()\r\n        NotifyIcon1.Text = <span style=\"color:#a31515\">&quot;СОПРО Client&quot;</span> &amp; vbCrLf &amp; <span style=\"color:#a31515\">&quot;Нет Активного Прослушивания&quot;</span>\r\n        NotifyIcon1.Visible = <span style=\"color:blue\">True</span>\r\n        OperatorName = GetSetting(<span style=\"color:#a31515\">&quot;SOPRO&quot;</span>, <span style=\"color:#a31515\">&quot;\\SETTINGS\\&quot;</span>, <span style=\"color:#a31515\">&quot;OperatorName&quot;</span>, 0)\r\n        StreamWavein.DeviceNumber = 0\r\n        StreamWavein.WaveFormat = <span style=\"color:blue\">New</span> NAudio.Wave.WaveFormat(16000, 1)\r\n        StreamWavein.StartRecording()\r\n\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Form1_FormClosing(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.Windows.Forms.FormClosingEventArgs) <span style=\"color:blue\">Handles</span> <span style=\"color:blue\">Me</span>.FormClosing\r\n        <span style=\"color:blue\">Try</span>\r\n            NotifyIcon1.Dispose()\r\n            <span style=\"color:blue\">Dim</span> filename <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Writer.Filename.ToString\r\n            StreamWavein.BufferMillisconds = 20 * 1000\r\n            Writer.Close()\r\n            LittleFIleName = DateAndTime.DateString &amp; <span style=\"color:#a31515\">&quot;_&quot;</span> &amp; Replace(DateAndTime.TimeOfDay, <span style=\"color:#a31515\">&quot;:&quot;</span>, <span style=\"color:#a31515\">&quot;-&quot;</span>) &amp; <span style=\"color:#a31515\">&quot;.tmp&quot;</span>\r\n            <span style=\"color:blue\">Dim</span> Filename2 = Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\&quot;</span> &amp; OperatorName &amp; <span style=\"color:#a31515\">&quot;_&quot;</span> &amp; LittleFIleName\r\n            File.Copy(filename, Filename2)\r\n            StreamWavein.BufferMillisconds = 1000\r\n            StreamWavein.StopRecording()\r\n\r\n            Writer.Close()\r\n            <span style=\"color:blue\">End</span>\r\n        <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> StreamWavein_DataAvailable(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> NAudio.Wave.WaveInEventArgs) <span style=\"color:blue\">Handles</span> StreamWavein.DataAvailable\r\n\r\n\r\n        <span style=\"color:blue\">Me</span>.Visible = <span style=\"color:blue\">False</span>\r\n        <span style=\"color:blue\">If</span> TCPSvr.Pending = <span style=\"color:blue\">True</span> <span style=\"color:blue\">Then</span>\r\n            acepted = <span style=\"color:blue\">True</span>\r\n            TCPClient = TCPSvr.AcceptTcpClient\r\n            NotifyIcon1.Icon = <span style=\"color:blue\">New</span> System.Drawing.Icon(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\LAME\\Rec.ico&quot;</span>)\r\n            NotifyIcon1.Text = <span style=\"color:#a31515\">&quot;СОПРО Client&quot;</span> &amp; vbCrLf &amp; <span style=\"color:#a31515\">&quot;Вас Прослушивают&quot;</span>\r\n            <span style=\"color:blue\">Try</span>\r\n                StreamSocket.Close()\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n            StreamSocket = TCPClient.GetStream()\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">If</span> acepted = <span style=\"color:blue\">True</span> <span style=\"color:blue\">Then</span>\r\n            <span style=\"color:blue\">Try</span>\r\n                StreamSocket.Write(e.Buffer, 0, e.BytesRecorded)\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n                NotifyIcon1.Icon = <span style=\"color:blue\">New</span> System.Drawing.Icon(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\LAME\\NotRec.ico&quot;</span>)\r\n                acepted = <span style=\"color:blue\">False</span>\r\n                NotifyIcon1.Text = <span style=\"color:#a31515\">&quot;СОПРО Client&quot;</span> &amp; vbCrLf &amp; <span style=\"color:#a31515\">&quot;Нет Соединения&quot;</span>\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">Try</span>\r\n\r\n            <span style=\"color:green\">'write captured data to .wav file</span>\r\n            Writer.WriteData(e.Buffer, 0, e.BytesRecorded)\r\n            \r\n            <span style=\"color:blue\">If</span> Writer.Length &gt; 57630600 <span style=\"color:blue\">Then</span>\r\n                <span style=\"color:blue\">Dim</span> filename <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Writer.Filename.ToString\r\n                StreamWavein.BufferMillisconds = 20 * 1000\r\n                Writer.Close()\r\n                LittleFIleName = DateAndTime.DateString &amp; <span style=\"color:#a31515\">&quot;_&quot;</span> &amp; Replace(DateAndTime.TimeOfDay, <span style=\"color:#a31515\">&quot;:&quot;</span>, <span style=\"color:#a31515\">&quot;-&quot;</span>) &amp; <span style=\"color:#a31515\">&quot;.tmp&quot;</span> <span style=\"color:green\">' Generate File Name</span>\r\n                <span style=\"color:blue\">Dim</span> Filename2 = Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\&quot;</span> &amp; OperatorName &amp; <span style=\"color:#a31515\">&quot;_&quot;</span> &amp; LittleFIleName\r\n                File.Copy(filename, Filename2)\r\n                StreamWavein.BufferMillisconds = 100\r\n                Shell(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\kill.cmd&quot;</span>, AppWinStyle.Hide)\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n\r\n\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> BackgroundWorker1_DoWork(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.ComponentModel.DoWorkEventArgs) <span style=\"color:blue\">Handles</span> BackgroundWorker1.DoWork\r\n        <span style=\"color:green\">'FTP Thread</span>\r\n        <span style=\"color:green\">'позволяет передовать сгенерированные файлы на сервер</span>\r\nstart:\r\n\r\n        <span style=\"color:blue\">Try</span>\r\n            <span style=\"color:blue\">Dim</span> Password <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = GetSetting(<span style=\"color:#a31515\">&quot;SOPRO&quot;</span>, <span style=\"color:#a31515\">&quot;\\SETTINGS\\&quot;</span>, <span style=\"color:#a31515\">&quot;SoproP&quot;</span>, 0)\r\n            <span style=\"color:blue\">Dim</span> UserName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = GetSetting(<span style=\"color:#a31515\">&quot;SOPRO&quot;</span>, <span style=\"color:#a31515\">&quot;\\SETTINGS\\&quot;</span>, <span style=\"color:#a31515\">&quot;USER&quot;</span>, 0)\r\n            <span style=\"color:blue\">Dim</span> serverName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = GetSetting(<span style=\"color:#a31515\">&quot;SOPRO&quot;</span>, <span style=\"color:#a31515\">&quot;\\SETTINGS\\&quot;</span>, <span style=\"color:#a31515\">&quot;SERVER&quot;</span>, 0)\r\n            <span style=\"color:blue\">Dim</span> Filename <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Dir(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\Encoded\\&quot;</span>, FileAttribute.System)\r\n            <span style=\"color:blue\">If</span> Len(Filename) &lt; 5 <span style=\"color:blue\">Then</span>\r\n                System.Threading.Thread.Sleep(1000)\r\n                <span style=\"color:blue\">GoTo</span> start\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n            <span style=\"color:blue\">Dim</span> FilenameTemp() <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Split(Filename, <span style=\"color:#a31515\">&quot;_&quot;</span>)\r\n            <span style=\"color:blue\">Dim</span> FromOperator <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = FilenameTemp(0)\r\n            <span style=\"color:blue\">Dim</span> DateOfFile <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = FilenameTemp(1)\r\n            <span style=\"color:blue\">Dim</span> TiMeofCreat <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = FilenameTemp(2)\r\n            <span style=\"color:blue\">Dim</span> readFile <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\Encoded\\&quot;</span> &amp; Filename\r\n            <span style=\"color:blue\">Dim</span> ParceDate() <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = Split(DateOfFile, <span style=\"color:#a31515\">&quot;-&quot;</span>)\r\n            <span style=\"color:blue\">Dim</span> FilenameLast <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = serverName &amp; OperatorName &amp; <span style=\"color:#a31515\">&quot;/&quot;</span> &amp; ParceDate(2) &amp; <span style=\"color:#a31515\">&quot;/&quot;</span> &amp; <span style=\"color:#a31515\">&quot;Month_&quot;</span> &amp; ParceDate(0) &amp; <span style=\"color:#a31515\">&quot;/&quot;</span> &amp; ParceDate(1) &amp; <span style=\"color:#a31515\">&quot;/&quot;</span> &amp; Filename\r\n            <span style=\"color:blue\">Dim</span> clsRequest <span style=\"color:blue\">As</span> System.Net.FtpWebRequest = _\r\n                <span style=\"color:blue\">DirectCast</span>(System.Net.WebRequest.Create(FilenameLast.ToString), System.Net.FtpWebRequest)\r\n            clsRequest.KeepAlive = <span style=\"color:blue\">False</span>\r\n            clsRequest.Credentials = <span style=\"color:blue\">New</span> System.Net.NetworkCredential(UserName.ToString, Password.ToString)\r\n            clsRequest.Method = System.Net.WebRequestMethods.Ftp.UploadFile\r\n            <span style=\"color:blue\">Dim</span> bFile() <span style=\"color:blue\">As</span> <span style=\"color:blue\">Byte</span> = System.IO.File.ReadAllBytes(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\Encoded\\&quot;</span> &amp; Filename)\r\n            <span style=\"color:blue\">Dim</span> clsStream <span style=\"color:blue\">As</span> System.IO.Stream = clsRequest.GetRequestStream()\r\n            clsStream.Write(bFile, 0, bFile.Length)\r\n            clsStream.Close()\r\n            clsStream.Dispose()\r\n            File.Delete(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Lame\\Encoded\\&quot;</span> &amp; Filename.ToString)\r\n            System.Threading.Thread.Sleep(1000)\r\n            <span style=\"color:blue\">GoTo</span> start\r\n        <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n            System.Threading.Thread.Sleep(1000)\r\n            <span style=\"color:blue\">GoTo</span> start\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Client Source Code:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:green\">'Naudio</span>\r\n<span style=\"color:blue\">Imports</span> Microsoft.DirectX.DirectSound\r\n<span style=\"color:blue\">Imports</span> NAudio\r\n<span style=\"color:blue\">Imports</span> Microsoft.VisualBasic.Devices\r\n<span style=\"color:blue\">Imports</span> System\r\n<span style=\"color:blue\">Imports</span> System.IO\r\n<span style=\"color:green\">'Listener</span>\r\n<span style=\"color:blue\">Imports</span> System.Net\r\n<span style=\"color:blue\">Imports</span> System.Net.Sockets\r\n<span style=\"color:blue\">Imports</span> System.Text\r\n<span style=\"color:blue\">Imports</span> Microsoft.VisualBasic\r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> Form1\r\n    <span style=\"color:blue\">Public</span> stoped <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>\r\n    <span style=\"color:blue\">Public</span> waveInFormat <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> NAudio.Wave.WaveFormat(16000, 1) <span style=\"color:green\">' Wave In format</span>\r\n    <span style=\"color:blue\">Public</span> Writer <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> Wave.WaveFileWriter(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\Waweout.waveout&quot;</span>, waveInFormat) <span style=\"color:green\">'Wave Stream Writer</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Form1_FormClosing(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.Windows.Forms.FormClosingEventArgs) <span style=\"color:blue\">Handles</span> <span style=\"color:blue\">Me</span>.FormClosing\r\n        stoped = <span style=\"color:blue\">True</span>\r\n        Writer.Close()\r\n       \r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Form1_Load(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> <span style=\"color:blue\">MyBase</span>.Load\r\n        ListBox1.Items.Add(<span style=\"color:#a31515\">&quot;adak&quot;</span>)\r\n       \r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> ListBox1_SelectedIndexChanged_1(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> ListBox1.SelectedIndexChanged\r\n        Button1.Enabled = <span style=\"color:blue\">True</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Button1_Click_1(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> Button1.Click\r\n        <span style=\"color:blue\">Select</span> <span style=\"color:blue\">Case</span> Button1.Text\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;Прослушать&quot;</span>\r\n                Label1.Focus()\r\n                Label1.Visible = <span style=\"color:blue\">True</span>\r\n                <span style=\"color:blue\">Dim</span> tempwaveSream <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> Wave.WaveFileWriter(Application.StartupPath &amp; <span style=\"color:#a31515\">&quot;\\movies\\&quot;</span> &amp; ListBox1.SelectedItem.ToString &amp; <span style=\"color:#a31515\">&quot;_&quot;</span> &amp; Replace(<span style=\"color:blue\">Date</span>.Now.ToString, <span style=\"color:#a31515\">&quot;:&quot;</span>, <span style=\"color:#a31515\">&quot;_&quot;</span>) &amp; <span style=\"color:#a31515\">&quot;.wav&quot;</span>, waveInFormat) <span style=\"color:green\">'Wave Stream Writer</span>\r\n                Label1.Text = <span style=\"color:#a31515\">&quot;Прослушивание Оператора &quot;</span> &amp; vbCrLf &amp; ListBox1.SelectedItem.ToString\r\n                Writer.Close()\r\n                Writer = tempwaveSream\r\n                ListBox1.Visible = <span style=\"color:blue\">False</span>\r\n                Button1.Text = <span style=\"color:#a31515\">&quot;Остановить&quot;</span>\r\n                stoped = <span style=\"color:blue\">False</span>\r\n                <span style=\"color:blue\">Dim</span> Message = <span style=\"color:#a31515\">&quot;HELLO&quot;</span>\r\n                <span style=\"color:blue\">Dim</span> client <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> TcpClient(<span style=\"color:#a31515\">&quot;127.0.0.1&quot;</span>, 3344)\r\n                <span style=\"color:blue\">Dim</span> data <span style=\"color:blue\">As</span> [<span style=\"color:blue\">Byte</span>]() = System.Text.Encoding.ASCII.GetBytes(Message)\r\n                <span style=\"color:blue\">Dim</span> stream <span style=\"color:blue\">As</span> NetworkStream = client.GetStream()\r\n                stream.Write(data, 0, data.Length)\r\n                data = <span style=\"color:blue\">New</span> [<span style=\"color:blue\">Byte</span>](3200) {}\r\n                <span style=\"color:blue\">Do</span>\r\n                    <span style=\"color:blue\">Try</span>\r\n                        <span style=\"color:blue\">If</span> stoped = <span style=\"color:blue\">True</span> <span style=\"color:blue\">Then</span>\r\n                            stream.Close()\r\n                            client.Close()\r\n                            <span style=\"color:blue\">Exit</span> <span style=\"color:blue\">Sub</span>\r\n                        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n                        Application.DoEvents()\r\n                        <span style=\"color:blue\">Dim</span> responseData <span style=\"color:blue\">As</span> [<span style=\"color:blue\">String</span>] = [<span style=\"color:blue\">String</span>].Empty\r\n                        stream.Read(data, 0, 3200)\r\n                        Writer.WriteData(data, 0, 3200)\r\n\r\n                    <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n                        MsgBox(ex.Message)\r\n                    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n                <span style=\"color:blue\">Loop</span>\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:blue\">Else</span>\r\n                Button1.Text = <span style=\"color:#a31515\">&quot;Прослушать&quot;</span>\r\n                Label1.Visible = <span style=\"color:blue\">False</span>\r\n                Button1.Top = 242\r\n                stoped = <span style=\"color:blue\">True</span>\r\n                Button1.Enabled = <span style=\"color:blue\">True</span>\r\n                ListBox1.Visible = <span style=\"color:blue\">True</span>\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Select</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class<br></span>\r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>When i connect to server and begin to recive strea....am save it into Wav file......after winamp can play it. But i cant play a recived stream(in a client side) to default sound output.</p>\r\n<p>the Programming language is Visual Basic .net 2008.</p>\r\n<p>Thanks a Lot</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-04-19T15:14:51.33-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "436465",
    "ThreadId": "209834",
    "Html": "<p>the key to understanding how to use NAudio is to create derived WaveStream classes. You need to derive from WaveStream and in the Read method, return buffered data you have received from the network</p>\r\n<p>Mark</p>",
    "PostedDate": "2010-04-28T04:46:49.477-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "462543",
    "ThreadId": "209834",
    "Html": "<p>I written on C#</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre> <span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> Waweprov : IWaveProvider, IDisposable\r\n    {\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">readonly</span> WaveFormat _wformat;\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">readonly</span> Queue&lt;<span style=\"color:blue\">byte</span>[]&gt; _input;\r\n\r\n        <span style=\"color:blue\">public</span> WaveFormat WaveFormat\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> _wformat; }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> Waweprov(WaveFormat wformat)\r\n        {\r\n            _wformat = wformat;\r\n            _input = <span style=\"color:blue\">new</span> Queue&lt;<span style=\"color:blue\">byte</span>[]&gt;();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Write(<span style=\"color:blue\">byte</span>[] buffer)\r\n        {\r\n            <span style=\"color:blue\">lock</span> (_input)\r\n                _input.Enqueue(buffer);\r\n        }\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">int</span> Read(<span style=\"color:blue\">byte</span>[] buffer, <span style=\"color:blue\">int</span> offset, <span style=\"color:blue\">int</span> count)\r\n        {\r\n            <span style=\"color:blue\">byte</span>[] readbuffer = <span style=\"color:blue\">null</span>;\r\n\r\n            <span style=\"color:blue\">lock</span> (_input)\r\n                <span style=\"color:blue\">if</span> (0 &lt; _input.Count)\r\n                    readbuffer = _input.Dequeue();\r\n\r\n            <span style=\"color:blue\">if</span> (<span style=\"color:blue\">null</span> != readbuffer)\r\n                Buffer.BlockCopy(readbuffer, 0, buffer, 0, count);\r\n\r\n            <span style=\"color:blue\">return</span> <span style=\"color:blue\">null</span> == readbuffer ? count : buffer.Length;\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Dispose()\r\n        {\r\n            <span style=\"color:blue\">lock</span> (_input)\r\n                _input.Clear();\r\n        }\r\n    }\r\n</pre>\r\n<pre><span id=\"result_box\"><span style=\"background-color:#e6ecf9;color:#000\">Data obtained unevenly at different intervals of time. </span></span></pre>\r\n<pre><span></span><span id=\"result_box\"><span style=\"background-color:#e6ecf9;color:#000\">The result can be heard repeating chunks of sound. </span></span></pre>\r\n<pre><span></span><span id=\"result_box\"><span style=\"background-color:#e6ecf9;color:#000\">How to stop play or can easily recover blank sample of</span></span>&nbsp;sound?</pre>\r\n</div>",
    "PostedDate": "2010-07-02T01:47:04.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "592046",
    "ThreadId": "209834",
    "Html": "<p>Did you get any success in Visual Basic after all?</p>",
    "PostedDate": "2011-04-05T07:23:02.307-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]