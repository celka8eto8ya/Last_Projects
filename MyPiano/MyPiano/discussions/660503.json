[
  {
    "Id": "1490655",
    "ThreadId": "660503",
    "Html": "Hello\r<br />\nin my callback procedure for a the asio input I can not use the audiometer. there will be a com exception message that this function is not supported. I used the code from asio example:\r<br />\n<br />\nI used for test explicitlly values for recordChannelCount and NAudio.Wave.AsioOut<br />\n<pre><code>               //int recordChannelCount = GetUserSpecifiedChannelCount();\n                int recordChannelCount = 1;\n\n                // create device if necessary\n                if (this.asioOut == null)\n                {\n                    //this.asioOut = new NAudio.Wave.AsioOut(comboBoxAsioDevice.Text); \n                    this.asioOut = new NAudio.Wave.AsioOut(0);\n\n                    //this.asioOut.InputChannelOffset = GetUserSpecifiedChannelOffset();\n                    this.asioOut.InputChannelOffset = 1;\n                    this.asioOut.InitRecordAndPlayback(null, recordChannelCount, 44100);\n                    this.asioOut.AudioAvailable += asioOut_AudioAvailable;\n                }\n\n                this.fileName = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString() + &quot;.wav&quot;);\n                this.writer = new WaveFileWriter(fileName, new WaveFormat(44100, recordChannelCount));\n                this.asioOut.Play();\n                this.timer1.Enabled = true;</code></pre>\n\n<hr />\nand the callback function:<br />\n<pre><code>\n\nvoid asioOut_AudioAvailable(object sender, AsioAudioAvailableEventArgs e)\n        {\n            var samples = e.GetAsInterleavedSamples();\n            writer.WriteSamples(samples, 0, samples.Length);\n\n\n            // bwp.AddSamples(e.Buffer, 0, e.BytesRecorded);\n            double duckWert = (double)Convert.ToDouble(globalRightVolume) * (double)((double)Convert.ToInt32(Program.myRemoteArranger.myConfigVerwaltung.duckReduktion) / 100);\n            var device = (NAudio.CoreAudioApi.MMDevice)Program.myRemoteArranger.myConfigVerwaltung.comboBox1.SelectedItem;\n            //int wert = (int)(Math.Round(device.AudioMeterInformation.MasterPeakValue * 1000));\n            int wert = (int)(Math.Round(device.AudioMeterInformation.MasterPeakValue * 2000));\n//.........\n}</code></pre>\n\nthe callback procedure crashes at the last line with: \r<br />\n_Das COM-Objekt des Typs &quot;System._<em>ComObject&quot; kann nicht in den Schnittstellentyp &quot;NAudio.CoreAudioApi.Interfaces.IMMDevice&quot; umgewandelt werden. Dieser Vorgang konnte nicht durchgef端hrt werden, da der QueryInterface-Aufruf an die COM-Komponente f端r die Schnittstelle mit der IID &quot;{D666063F-1587-4E43-81F1-B948E807363F}&quot; aufgrund des folgenden Fehlers nicht durchgef端hrt werden konnte: Schnittstelle nicht unterst端tzt (Ausnahme von HRESULT: 0x80004002 (E_NOINTERFACE)).</em>\r<br />\n<br />\nCould someone help me? Thank you very much.\r<br />\nThom<br />\n",
    "PostedDate": "2017-01-05T02:38:54.593-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]