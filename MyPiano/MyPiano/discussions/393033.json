[
  {
    "Id": "903933",
    "ThreadId": "393033",
    "Html": "\r\n<p>Hello Mark,</p>\r\n<p>thank you for creating this avesome possibility to play audio files.</p>\r\n<p>I am currently working on a project that has to &quot;fade&quot; between two mp3 files. To accomplish that I created an array of two WaveOut&acute;s in order to play the two files simultaneously and increase the volume of the first WaveOut respectively decrease the\r\n volume of the second.</p>\r\n<p>Obviously I misunderstood the use of WaveOut - Setting the volume of one of the WaveOut-Objects leads into changing the &quot;master&quot;-volume of the program.</p>\r\n<p>Is there any way to change the volume of the &quot;streams&quot; ?</p>\r\n<p>This is my current code (VB 2010):</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Option</span> Strict <span style=\"color:blue\">Off</span>\n<span style=\"color:blue\">Option</span> <span style=\"color:blue\">Explicit</span> <span style=\"color:blue\">On</span>\n<span style=\"color:blue\">Imports</span> Microsoft.Win32\n<span style=\"color:blue\">Imports</span> NAudio\n<span style=\"color:blue\">Imports</span> NAudio.Wave\n\n<span style=\"color:blue\">Module</span> globPlayFile\n    <span style=\"color:blue\">Public</span> Player(2) <span style=\"color:blue\">As</span> WaveOut\n    <span style=\"color:blue\">Public</span> Stream(2) <span style=\"color:blue\">As</span> WaveStream\n    <span style=\"color:blue\">Public</span> volumeStream(2) <span style=\"color:blue\">As</span> WaveChannel32\n    <span style=\"color:blue\">Public</span> inputStream(2) <span style=\"color:blue\">As</span> WaveChannel32\n    <span style=\"color:blue\">Public</span> mainOutputStream(2) <span style=\"color:blue\">As</span> WaveStream\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Function</span> MP3_Play(<span style=\"color:blue\">ByVal</span> sFile <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>, <span style=\"color:blue\">ByVal</span> sIndex <span style=\"color:blue\">As</span> <span style=\"color:blue\">Short</span>) <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>\n        <span style=\"color:green\">'On Error Resume Next</span>\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> Player(sIndex) <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            Player(sIndex).Dispose()\n            Player(sIndex) = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> Stream(sIndex) <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            Stream(sIndex).Dispose()\n            Stream(sIndex) = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n        mainOutputStream(sIndex) = CreateInputStream(sFile, sIndex)\n        Player(sIndex) = <span style=\"color:blue\">New</span> WaveOut()\n        Player(sIndex).Init(mainOutputStream(sIndex))\n        Player(sIndex).Play()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Function</span> CreateInputStream(<span style=\"color:blue\">ByVal</span> fileName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>, <span style=\"color:blue\">ByVal</span> sIndex <span style=\"color:blue\">As</span> <span style=\"color:blue\">Short</span>) <span style=\"color:blue\">As</span> WaveStream\n        Stream(sIndex) = <span style=\"color:blue\">New</span> Mp3FileReader(fileName)\n        inputStream(sIndex) = <span style=\"color:blue\">New</span> WaveChannel32(Stream(sIndex))\n        volumeStream(sIndex) = inputStream(sIndex)\n        <span style=\"color:blue\">Return</span> volumeStream(sIndex)\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\n\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> MP3_SetVolume(<span style=\"color:blue\">ByVal</span> sIndex <span style=\"color:blue\">As</span> <span style=\"color:blue\">Short</span>, <span style=\"color:blue\">ByVal</span> nVolume <span style=\"color:blue\">As</span> <span style=\"color:blue\">Single</span>)\n        <span style=\"color:green\">'On Error Resume Next</span>\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> Player(sIndex) <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            Player(sIndex).Volume = nVolume\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Module</span>\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Now I am using a timer to increase the volume of one WaveOut (via MP3_SetVolume) while deresing the volume of the other one.</p>\r\n<p>Thank you in advance!</p>\r\n<p>Greetings from Germany!</p>\r\n<p>Sebastian</p>\r\n",
    "PostedDate": "2012-08-25T03:14:26.983-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "904050",
    "ThreadId": "393033",
    "Html": "<p>Hi,</p>\r\n<p>I am getting closer. Another discussion entry gave me the idea of changing the Volume on the input streams. Now I can handle the volume of the two MP3-files seperately.</p>\r\n<p>Unfortunately this brings me to another Problem: When I init the second WaveOut, I get a short mute on all other playing MP3-Files. This delay is just a split second but you can hear the short moment of silence.</p>\r\n<p>Any idea how to remove this error?</p>\r\n<p>Thank you in advance!</p>\r\n<p>Sebastian</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Imports</span> NAudio\r\n<span style=\"color: blue;\">Imports</span> NAudio.Wave\r\n<span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Class</span> Form1\r\n    <span style=\"color: blue;\">Public</span> Player(2) <span style=\"color: blue;\">As</span> WaveOut\r\n    <span style=\"color: blue;\">Public</span> Stream(2) <span style=\"color: blue;\">As</span> WaveStream\r\n    <span style=\"color: blue;\">Public</span> volumeStream(2) <span style=\"color: blue;\">As</span> WaveChannel32\r\n    <span style=\"color: blue;\">Public</span> inputStream(2) <span style=\"color: blue;\">As</span> WaveChannel32\r\n    <span style=\"color: blue;\">Public</span> mainOutputStream(2) <span style=\"color: blue;\">As</span> WaveStream\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button1_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button1.Click\r\n        OpenFileDialog1.Title = <span style=\"color: #a31515;\">\"Choose MP3 file to play!\"</span>\r\n        OpenFileDialog1.ShowDialog()\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button2_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button2.Click\r\n        OpenFileDialog2.Title = <span style=\"color: #a31515;\">\"Choose MP3 file to play!\"</span>\r\n        OpenFileDialog2.ShowDialog()\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button3_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button3.Click\r\n        Player(1).Play()\r\n        Button3.Enabled = <span style=\"color: blue;\">False</span>\r\n        Button5.Enabled = <span style=\"color: blue;\">True</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button4_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button4.Click\r\n        Player(2).Play()\r\n        Button4.Enabled = <span style=\"color: blue;\">False</span>\r\n        Button6.Enabled = <span style=\"color: blue;\">True</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button5_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button5.Click\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> Player(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            Player(1).<span style=\"color: blue;\">Stop</span>()\r\n            Player(1).Dispose()\r\n            Player(1) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> Stream(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            Stream(1).Dispose()\r\n            Stream(1) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> volumeStream(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            volumeStream(1).Dispose()\r\n            volumeStream(1) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> inputStream(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            inputStream(1).Dispose()\r\n            inputStream(1) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> mainOutputStream(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            mainOutputStream(1).Dispose()\r\n            mainOutputStream(1) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n        Button5.Enabled = <span style=\"color: blue;\">False</span>\r\n        Button1.Enabled = <span style=\"color: blue;\">True</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> Button6_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> Button6.Click\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> Player(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            Player(2).<span style=\"color: blue;\">Stop</span>()\r\n            Player(2).Dispose()\r\n            Player(2) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> Stream(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            Stream(2).Dispose()\r\n            Stream(2) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> volumeStream(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            volumeStream(2).Dispose()\r\n            volumeStream(2) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> inputStream(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            inputStream(2).Dispose()\r\n            inputStream(2) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> mainOutputStream(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            mainOutputStream(2).Dispose()\r\n            mainOutputStream(2) = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n        Button6.Enabled = <span style=\"color: blue;\">False</span>\r\n        Button2.Enabled = <span style=\"color: blue;\">True</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> OpenFileDialog1_FileOk(sender <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Object</span>, e <span style=\"color: blue;\">As</span> System.ComponentModel.CancelEventArgs) <span style=\"color: blue;\">Handles</span> OpenFileDialog1.FileOk\r\n        mainOutputStream(1) = CreateInputStream(OpenFileDialog1.FileName.ToString, 1)\r\n        Player(1) = <span style=\"color: blue;\">New</span> WaveOut()\r\n        Player(1).Init(mainOutputStream(1))\r\n        Button3.Enabled = <span style=\"color: blue;\">True</span>\r\n        Button1.Enabled = <span style=\"color: blue;\">False</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> OpenFileDialog2_FileOk(sender <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Object</span>, e <span style=\"color: blue;\">As</span> System.ComponentModel.CancelEventArgs) <span style=\"color: blue;\">Handles</span> OpenFileDialog2.FileOk\r\n        mainOutputStream(2) = CreateInputStream(OpenFileDialog2.FileName.ToString, 2)\r\n        Player(2) = <span style=\"color: blue;\">New</span> WaveOut()\r\n        Player(2).Init(mainOutputStream(2)) <span style=\"color: green;\">'This leads into the short silence on the track playing on Player(1)</span>\r\n        Button4.Enabled = <span style=\"color: blue;\">True</span>\r\n        Button2.Enabled = <span style=\"color: blue;\">False</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Function</span> CreateInputStream(<span style=\"color: blue;\">ByVal</span> fileName <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">String</span>, <span style=\"color: blue;\">ByVal</span> sIndex <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Short</span>) <span style=\"color: blue;\">As</span> WaveStream\r\n        Stream(sIndex) = <span style=\"color: blue;\">New</span> Mp3FileReader(fileName)\r\n        inputStream(sIndex) = <span style=\"color: blue;\">New</span> WaveChannel32(Stream(sIndex))\r\n        volumeStream(sIndex) = inputStream(sIndex)\r\n        <span style=\"color: blue;\">Return</span> volumeStream(sIndex)\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Function</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> TrackBar1_ValueChanged(sender <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Object</span>, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> TrackBar1.ValueChanged\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> inputStream(1) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            <span style=\"color: blue;\">Dim</span> tmpVolume <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Single</span>\r\n            tmpVolume = TrackBar1.Value / 100\r\n            inputStream(1).Volume = tmpVolume\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> TrackBar2_ValueChanged(sender <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Object</span>, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> TrackBar2.ValueChanged\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> inputStream(2) <span style=\"color: blue;\">Is</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            <span style=\"color: blue;\">Dim</span> tmpVolume <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Single</span>\r\n            tmpVolume = TrackBar2.Value / 100\r\n            inputStream(2).Volume = tmpVolume\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n<span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Class</span>\r\n\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-08-25T13:39:59.89-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "904762",
    "ThreadId": "393033",
    "Html": "<p>that's strange. Could it be the garbage collector kicking in momentarily perhaps? An alternative approach is to have just one WaveOut and mix the MP3s to be sent to it in software. This is a more complicated solution in terms of code though.</p>",
    "PostedDate": "2012-08-27T13:52:30.49-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]