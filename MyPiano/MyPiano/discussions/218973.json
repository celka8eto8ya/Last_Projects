[
  {
    "Id": "465644",
    "ThreadId": "218973",
    "Html": "<p>Maybe someone could help with a conversion to vb.net. How do I get the value from&nbsp;or call it. I am new to this and working on a simple project (I think) that will detect audio from my sound card.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<pre>Imports System\r\nImports System.Collections.Generic\r\nImports System.ComponentModel\r\nImports System.Data\r\nImports System.Drawing\r\nImports System.Text\r\nImports System.Windows.Forms\r\nImports NAudio.Wave\r\nImports System.Diagnostics\r\n\r\nPublic Class Form1\r\n    Private AudioThresh As Double = 0.09\r\n    Private waveInStream As WaveInStream\r\n    Private WaveIn As WaveIn\r\n    'When button Test is clicked, start listening for sound\r\n\r\n    Private Sub btnTest_Click(ByVal sender As Object, ByVal e As EventArgs)\r\n        'waveInStream = WaveIn(44100, 1)\r\n        AddHandler waveInStream.DataAvailable, AddressOf waveInStream_DataAvailable\r\n        'waveInStream.StartRecording()\r\n    End Sub\r\n\r\n    'Handler for the sound listener\r\n    Private Sub waveInStream_DataAvailable(ByVal sender As Object, ByVal e As WaveInEventArgs)\r\n        Dim result As Boolean = ProcessData(e)\r\n        If result Then\r\n            MessageBox.Show(&quot;peak in sound?&quot;)\r\n            'no peak in sound\r\n        Else\r\n        End If\r\n    End Sub\r\n\r\n    'calculate the sound level based on the AudioThresh\r\n    Private Function ProcessData(ByVal e As WaveInEventArgs) As Boolean\r\n        Dim result As Boolean = False\r\n        Dim Tr As Boolean = False\r\n        Dim Sum2 As Double = 0\r\n        Dim Count As Integer = e.BytesRecorded / 2\r\n        For index As Integer = 0 To e.BytesRecorded - 1 Step 2\r\n            Dim Tmp As Double = CShort((e.Buffer(index + 1) &lt;&lt; 8) Or e.Buffer(index + 0))\r\n            Tmp /= 32768.0\r\n            Sum2 += Tmp * Tmp\r\n            If Tmp &gt; AudioThresh Then\r\n                Tr = True\r\n            End If\r\n        Next\r\n        Sum2 /= Count\r\n        ' If the Mean-Square is greater than a threshold, set a flag to indicate that noise has happened\r\n        If Tr OrElse Sum2 &gt; AudioThresh Then\r\n            result = True\r\n            MsgBox(&quot;yes&quot;)\r\n\r\n        Else\r\n            result = False\r\n            MsgBox(&quot;no&quot;)\r\n\r\n        End If\r\n        Return result\r\n    End Function\r\n\r\nEnd Class</pre>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-07-09T14:30:49.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]