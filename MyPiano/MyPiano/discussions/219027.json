[
  {
    "Id": "465833",
    "ThreadId": "219027",
    "Html": "<div id=\"ctl00_ctl00_MasterContent_Content_PostRepeater_ctl26_BodyDiv\">\r\n<p>Maybe someone could help with a  conversion to vb.net. How do I get the value from&nbsp;or call it. I am new  to this and working on a simple project (I think) that will detect audio  from my sound card. Started here http://naudio.codeplex.com/Thread/View.aspx?ThreadId=85739</p>\r\n<p>&nbsp;</p>\r\n<pre>Imports System<br>Imports System.Collections.Generic<br>Imports System.ComponentModel<br>Imports System.Data<br>Imports System.Drawing<br>Imports System.Text<br>Imports System.Windows.Forms<br>Imports NAudio.Wave<br>Imports System.Diagnostics<br><br>Public Class Form1<br>    Private AudioThresh As Double = 0.09<br>    Private waveInStream As WaveInStream<br>    Private WaveIn As WaveIn<br>    'When button Test is clicked, start listening for sound<br><br>    Private Sub btnTest_Click(ByVal sender As Object, ByVal e As EventArgs)<br>        'waveInStream = WaveIn(44100, 1)<br>        AddHandler waveInStream.DataAvailable, AddressOf waveInStream_DataAvailable<br>        'waveInStream.StartRecording()<br>    End Sub<br><br>    'Handler for the sound listener<br>    Private Sub waveInStream_DataAvailable(ByVal sender As Object, ByVal e As WaveInEventArgs)<br>        Dim result As Boolean = ProcessData(e)<br>        If result Then<br>            MessageBox.Show(&quot;peak in sound?&quot;)<br>            'no peak in sound<br>        Else<br>        End If<br>    End Sub<br><br>    'calculate the sound level based on the AudioThresh<br>    Private Function ProcessData(ByVal e As WaveInEventArgs) As Boolean<br>        Dim result As Boolean = False<br>        Dim Tr As Boolean = False<br>        Dim Sum2 As Double = 0<br>        Dim Count As Integer = e.BytesRecorded / 2<br>        For index As Integer = 0 To e.BytesRecorded - 1 Step 2<br>            Dim Tmp As Double = CShort((e.Buffer(index + 1) &lt;&lt; 8) Or e.Buffer(index + 0))<br>            Tmp /= 32768.0<br>            Sum2 += Tmp * Tmp<br>            If Tmp &gt; AudioThresh Then<br>                Tr = True<br>            End If<br>        Next<br>        Sum2 /= Count<br>        ' If the Mean-Square is greater than a threshold, set a flag to indicate that noise has happened<br>        If Tr OrElse Sum2 &gt; AudioThresh Then<br>            result = True<br>            MsgBox(&quot;yes&quot;)<br><br>        Else<br>            result = False<br>            MsgBox(&quot;no&quot;)<br><br>        End If<br>        Return result<br>    End Function<br><br>End Class</pre>\r\n</div>",
    "PostedDate": "2010-07-10T11:09:34.983-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]