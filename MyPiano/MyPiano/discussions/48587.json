[
  {
    "Id": "162220",
    "ThreadId": "48587",
    "Html": "I am trying to create a small program that takes a given WAV file and converts it to a compressed ADPCM WAV. I have got the code working with the GetTargetFormat prompt but when i try to crearte my own WaveFormat it causes an &quot;AcmNotPossible calling acmStreamOpen&quot; error. My code is posted below:<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (WaveFileReader reader = new WaveFileReader(txtIName.Text))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Set encoding settings using prompt<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WaveFormat targetFormat = GetTargetFormat(reader.WaveFormat);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Set encoding settings programatically<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //WaveFormat targetFormat = WaveFormat.CreateCustomFormat(WaveFormatEncoding.DigiAdpcm, 8000, 1, 4055, 256, 4); <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Convert to new format<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (WaveStream convertedStream = new WaveFormatConversionStream(targetFormat, reader))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WaveFileWriter.CreateWaveFile(txtOName.Text, convertedStream);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nAny help will be greatly appreciated.<br>\r\n",
    "PostedDate": "2009-02-26T01:42:27.77-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162303",
    "ThreadId": "48587",
    "Html": "Depending upon what the target format is and your input is, you may need to use multiple WaveFormatConversionStreams in order to perform the conversion within multiple steps. Also, I noticed that the WaveFormatConversionStreamTests use an AdpcmWaveFormat constructor.<br>\r\n",
    "PostedDate": "2009-02-26T06:09:43.96-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162306",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">The input is a PCM 16bit signed 8000Hz 128kpbs mono WAV and I want\r\nto convert to an IMA ADPCM 8000Hz 4bit mono WAV. As I said earlier if I use the\r\nprompt to set the settings it works fine, it only gives the error if I try and set\r\nthe settings in the code using the WaveFormat static method (this is\r\ndemonstrated in the code exert I included) so I don’t think I will have to use\r\nmultiple streams.</span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\"> </span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">Thanks for your help.</span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm\">\r\n\r\n<p class=MsoNormal><b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> geiman [mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Friday, 27 February 2009 1:10 AM<br>\r\n<b>To:</b> Scott Edwards<br>\r\n<b>Subject:</b> Re: AcmNotPossible calling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\ngeiman</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">Depending\r\nupon what the target format is and your input is, you may need to use multiple\r\nWaveFormatConversionStreams in order to perform the conversion within multiple\r\nsteps. Also, I noticed that the WaveFormatConversionStreamTests use an\r\nAdpcmWaveFormat constructor.</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://www.codeplex.com/naudio/Thread/View.aspx?ThreadId=48587&ANCHOR#Post162303\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-02-26T06:23:55.603-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162379",
    "ThreadId": "48587",
    "Html": "WaveFormat.CreateCustomFormat only works if the format in question doesn't have any extra bytes beyond the WAVEFORMAT structure. So you may have to create your own class derived from WaveFormat, in the same way that AdpcmWaveFormat does. These things are a real pain to figure out, but at least you could inspect the WaveFormat created by the NAudioDemo app to see what ought to be in there.<br>\r\n<br>\r\nMark<br>\r\n<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-26T08:53:05.18-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162392",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span lang=EN-US style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:black\">Are you saying create a class that inherits WaveFormat so that I can\r\ncreate a method and actually set ExtraSize? I did notice that I wasn’t able to\r\nset this but the WaveFormat that is created by the prompt has this set to 2.\r\nThe only issue that I have with this is that I actaully captured the WaveFormat\r\nobject created by the prompt and then wrote that to a binary file so that I could\r\nthen read it back at a later time to get around not being able to set ExtraSize\r\nand to ensure there wasn’t anything else being set that I wasn’t aware of. This\r\nworked in the fact that i now had a WaveFormat with ExtraSize set to 2 (loaded\r\nfrom the binary file) but unfortuantely it still threw the error.</span></p>\r\n\r\n<p class=MsoNormal><span lang=EN-US style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:black\"> </span></p>\r\n\r\n<p class=MsoNormal><span lang=EN-US style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:black\">Sorry if I miss understood what you were saying.</span><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\"></span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm\">\r\n\r\n<p class=MsoNormal><b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> markheath\r\n[mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Friday, 27 February 2009 3:53 AM<br>\r\n<b>To:</b> Scott Edwards<br>\r\n<b>Subject:</b> Re: AcmNotPossible calling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\nmarkheath</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal style=\"margin-bottom:12.0pt\"><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">WaveFormat.CreateCustomFormat only works if\r\nthe format in question doesn't have any extra bytes beyond the WAVEFORMAT\r\nstructure. So you may have to create your own class derived from WaveFormat, in\r\nthe same way that AdpcmWaveFormat does. These things are a real pain to figure\r\nout, but at least you could inspect the WaveFormat created by the NAudioDemo\r\napp to see what ought to be in there.<br>\r\n<br>\r\nMark<br>\r\n<br>\r\n</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://www.codeplex.com/naudio/Thread/View.aspx?ThreadId=48587&ANCHOR#Post162379\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-02-26T09:06:55.573-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162419",
    "ThreadId": "48587",
    "Html": "Yes, but you not only need to set <strong>ExtraSize</strong>, you need to fill in the data that makes up that extra size. If it is two, then in your derived class add an <strong>Int16</strong> for the extra data, and set it to the appropriate values in its constructor.<br>\r\n",
    "PostedDate": "2009-02-26T10:00:20.66-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162588",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">I have tried that but it doesn’t seem to accept my child class\r\nwhen I try and pass it to WaveFormatConversionStream it won’t accept it because\r\nit isn’t of type WaveFormat (even though it should through Polymorphism) and I have\r\ntried casting and all sorts of things and it just errors saying it can’t\r\nconvert MyWaveFormat to WaveFormat.</span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\"> </span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm\">\r\n\r\n<p class=MsoNormal><b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> markheath\r\n[mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Friday, 27 February 2009 5:00 AM<br>\r\n<b>To:</b> Scott Edwards<br>\r\n<b>Subject:</b> Re: AcmNotPossible calling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\nmarkheath</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">Yes,\r\nbut you not only need to set <strong><span style=\"font-family:'Verdana','sans-serif'\">ExtraSize</span></strong>,\r\nyou need to fill in the data that makes up that extra size. If it is two, then\r\nin your derived class add an <strong><span style=\"font-family:'Verdana','sans-serif'\">Int16</span></strong>\r\nfor the extra data, and set it to the appropriate values in its constructor.</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://www.codeplex.com/naudio/Thread/View.aspx?ThreadId=48587&ANCHOR#Post162419\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-02-26T20:23:20.123-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "163464",
    "ThreadId": "48587",
    "Html": "I'm not sure why that would happen. Can you share your code for your derived WaveFormat class?<br>\r\n",
    "PostedDate": "2009-03-02T04:27:03.223-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "163705",
    "ThreadId": "48587",
    "Html": "Here is the code for the class:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\nprivate class MyWaveFormat:WaveFormat<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MyWaveFormat(WaveFormatEncoding WaveFormatTag, short BitsPerSample, short Channels, int AverageBytesPerSecond, short BlockAlign, int SampleRate, short ExtraSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.extraSize = ExtraSize;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.averageBytesPerSecond = AverageBytesPerSecond;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.bitsPerSample = BitsPerSample;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.blockAlign = BlockAlign;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.channels = Channels;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.sampleRate = SampleRate;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.waveFormatTag = WaveFormatTag;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n}<br>\r\n<br>\r\nI then changed the code as follows:<br>\r\n<br>\r\nusing (WaveFileReader reader = new WaveFileReader(txtIName.Text))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyWaveFormat targetFormat = new MyWaveFormat(WaveFormatEncoding.DigiAdpcm, 8000, 1, 4055, 256, 4, 2);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Convert to new format<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (WaveStream convertedStream = new WaveFormatConversionStream(targetFormat, reader))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WaveFileWriter.CreateWaveFile(txtOName.Text, convertedStream);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nThere is no issues detected but when i run the program i get the following error &quot;Type 'WAV_Encoding_Test.Form1+MyWaveFormat' cannot be marshaled as an unmanaged structure; no meaningful size or offset can be computed.&quot; \r\n",
    "PostedDate": "2009-03-02T22:31:08.673-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "163808",
    "ThreadId": "48587",
    "Html": "That's a strange one. Can you try the following<br>\r\n1. Make your class public<br>\r\n2. Move it out of Form1 (no longer a nested class)<br>\r\n3. Add a private member of type short (to store your &quot;extra&quot; 2 bytes)<br>\r\n<br>\r\nMark<br>\r\n",
    "PostedDate": "2009-03-03T04:47:43.183-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "164143",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">Could you clarify step three for me?</span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\"> </span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm\">\r\n\r\n<p class=MsoNormal><b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> markheath\r\n[mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Tuesday, 3 March 2009 11:48 PM<br>\r\n<b>To:</b> Scott Edwards<br>\r\n<b>Subject:</b> Re: AcmNotPossible calling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\nmarkheath</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">That's\r\na strange one. Can you try the following<br>\r\n1. Make your class public<br>\r\n2. Move it out of Form1 (no longer a nested class)<br>\r\n3. Add a private member of type short (to store your &quot;extra&quot; 2 bytes)<br>\r\n<br>\r\nMark</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://naudio.codeplex.com/Thread/View.aspx?ThreadId=48587&ANCHOR#Post163808\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-03-03T19:34:24.503-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "164214",
    "ThreadId": "48587",
    "Html": "Simply add a short in there. Extra size means how many extra bytes there are on top of the original WaveFormat structure. You need a variable to hold that data (a short because you have two extra bytes). And you should also set the contents of that extra data according to the specification of the specific WaveFormatTag you are using<br>\r\n<br>\r\nprivate class MyWaveFormat:WaveFormat<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short extraData;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MyWaveFormat(WaveFormatEncoding WaveFormatTag, short\r\nBitsPerSample, short Channels, int AverageBytesPerSecond, short\r\nBlockAlign, int SampleRate, short ExtraSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.extraSize = ExtraSize;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.averageBytesPerSecond = AverageBytesPerSecond;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.bitsPerSample = BitsPerSample;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.blockAlign = BlockAlign;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.channels = Channels;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.sampleRate = SampleRate;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.waveFormatTag = WaveFormatTag;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n}\r\n",
    "PostedDate": "2009-03-04T01:31:14.753-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "164251",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:10.0pt;font-family:Arial;color:navy\">Sorry I should have been more specific I was\r\nasking how I was to set the extraData variable. Do I just read the first two\r\nbytes of the file into it?</span></p>\r\n\r\n<div>\r\n\r\n<div class=MsoNormal align=center style=\"text-align:center\"><span style=\"font-size:12.0pt\">\r\n\r\n<hr size=2 width=\"100%\" align=center>\r\n\r\n</span></div>\r\n\r\n<p class=MsoNormal><b><span style=\"font-size:10.0pt;font-family:Tahoma;font-weight:bold\">From:</span></b><span style=\"font-size:10.0pt;font-family:Tahoma\"> markheath\r\n[mailto:notifications@codeplex.com] <br>\r\n<b><span style=\"font-weight:bold\">Sent:</span></b> Wednesday, 4 March 2009 8:31\r\nPM<br>\r\n<b><span style=\"font-weight:bold\">To:</span></b> Scott Edwards<br>\r\n<b><span style=\"font-weight:bold\">Subject:</span></b> Re: AcmNotPossible\r\ncalling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal><span style=\"font-size:12.0pt\"> </span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana\">From:\r\nmarkheath</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal><span style=\"font-size:9.0pt;font-family:Verdana\">Simply add a short in there. Extra size means how many\r\nextra bytes there are on top of the original WaveFormat structure. You need a\r\nvariable to hold that data (a short because you have two extra bytes). And you\r\nshould also set the contents of that extra data according to the specification\r\nof the specific WaveFormatTag you are using<br>\r\n<br>\r\nprivate class MyWaveFormat:WaveFormat<br>\r\n        {<br>\r\n            short\r\nextraData;<br>\r\n<br>\r\n            public\r\nMyWaveFormat(WaveFormatEncoding WaveFormatTag, short BitsPerSample, short\r\nChannels, int AverageBytesPerSecond, short BlockAlign, int SampleRate, short\r\nExtraSize)<br>\r\n            {<br>\r\n               \r\nbase.extraSize = ExtraSize;<br>\r\n               \r\nbase.averageBytesPerSecond = AverageBytesPerSecond;<br>\r\n               \r\nbase.bitsPerSample = BitsPerSample;<br>\r\n               \r\nbase.blockAlign = BlockAlign;<br>\r\n               \r\nbase.channels = Channels;<br>\r\n               \r\nbase.sampleRate = SampleRate;<br>\r\n               \r\nbase.waveFormatTag = WaveFormatTag;<br>\r\n            }<br>\r\n} </span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana;color:gray\">Read the <a href=\"http://naudio.codeplex.com/Thread/View.aspx?ThreadId=48587&ANCHOR#Post164214\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana;color:gray\">To add a post to this discussion, reply to this\r\nemail (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana;color:gray\">To start a new discussion for this project,\r\nemail <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana;color:gray\">You are receiving this email because you\r\nsubscribed to this discussion on CodePlex. You can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:Verdana;color:gray\">Please note: Images and attachments will be\r\nremoved from emails. Any posts to this discussion will also be available online\r\nat codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-03-04T03:54:04.61-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "165296",
    "ThreadId": "48587",
    "Html": "the 2 extra bytes likely contain configuration flags / values for the decoder. What they should contain depends entirely on what compression format you are using<br>\r\n",
    "PostedDate": "2009-03-06T04:33:08.817-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "168382",
    "ThreadId": "48587",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">The original file is PCM and I am converting to ADPCM. So what\r\nwill I be required to do?</span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\"> </span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm\">\r\n\r\n<p class=MsoNormal><b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span lang=EN-US style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> markheath\r\n[mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Friday, 6 March 2009 11:33 PM<br>\r\n<b>To:</b> Scott Edwards<br>\r\n<b>Subject:</b> Re: AcmNotPossible calling acmStreamOpen [naudio:48587]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\nmarkheath</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p class=MsoNormal><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">the\r\n2 extra bytes likely contain configuration flags / values for the decoder. What\r\nthey should contain depends entirely on what compression format you are using</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 0cm\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://naudio.codeplex.com/Thread/View.aspx?ThreadId=48587&ANCHOR#Post165296\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:naudio@discussions.codeplex.com?subject=[naudio:48587]\">naudio@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:naudio@discussions.codeplex.com\">naudio@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/48587\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-03-15T18:28:04-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "171240",
    "ThreadId": "48587",
    "Html": "Use the NAudioDemo app to do a conversion, and debug it to see what the values of those two extra bytes are.<br>\r\n",
    "PostedDate": "2009-03-24T02:44:47.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]