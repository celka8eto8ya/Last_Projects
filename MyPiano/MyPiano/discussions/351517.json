[
  {
    "Id": "821097",
    "ThreadId": "351517",
    "Html": "<p>I followed the tutorial:</p>\n<p><a href=\"http://naudio.codeplex.com/wikipage?title=MP3\">http://naudio.codeplex.com/wikipage?title=MP3</a></p>\n<p>But it gives me that error \"acmstreamheader dispose was not called\".</p>\n<p>&nbsp;</p>\n<p>I found this on google:</p>\n<p><a href=\"http://efreedom.com/Question/1-6361202/Getting-Error-Exiting-Program-Loading-Wav-Using-NAudio\">http://efreedom.com/Question/1-6361202/Getting-Error-Exiting-Program-Loading-Wav-Using-NAudio</a></p>\n<p>But that doesn't solve my problem either.</p>\n<p>&nbsp;</p>\n<p>My code (the Dispose() is called in the Form.Closing event):</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>        WaveChannel32 volumeStream;\n        <span style=\"color: blue;\">private</span> WaveStream CreateInputStream(<span style=\"color: blue;\">string</span> fileName)\n        {\n            WaveChannel32 inputStream;\n            <span style=\"color: blue;\">if</span> (fileName.EndsWith(<span style=\"color: #a31515;\">\".mp3\"</span>))\n            {\n                WaveStream mp3Reader = <span style=\"color: blue;\">new</span> Mp3FileReader(fileName);\n                inputStream = <span style=\"color: blue;\">new</span> WaveChannel32(mp3Reader);\n            }\n            <span style=\"color: blue;\">else</span>\n            {\n                <span style=\"color: blue;\">throw</span> <span style=\"color: blue;\">new</span> InvalidOperationException(<span style=\"color: #a31515;\">\"Unsupported extension\"</span>);\n            }\n            volumeStream = inputStream;\n            <span style=\"color: blue;\">return</span> volumeStream;\n        }\n\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">void</span> Dispose()\n        {\n            <span style=\"color: blue;\">if</span> (waveOutDevice != <span style=\"color: blue;\">null</span>)\n            {\n                waveOutDevice.Stop();\n            }\n            <span style=\"color: blue;\">if</span> (mainOutputStream != <span style=\"color: blue;\">null</span>)\n            {\n                <span style=\"color: green;\">// this one really closes the file and ACM conversion</span>\n                volumeStream.Close();\n                volumeStream = <span style=\"color: blue;\">null</span>;\n                <span style=\"color: green;\">// this one does the metering stream</span>\n                mainOutputStream.Close();\n                mainOutputStream = <span style=\"color: blue;\">null</span>;\n            }\n            <span style=\"color: blue;\">if</span> (waveOutDevice != <span style=\"color: blue;\">null</span>)\n            {\n                waveOutDevice.Dispose();\n                waveOutDevice = <span style=\"color: blue;\">null</span>;\n            }\n        }\n\n        IWavePlayer waveOutDevice;\n        WaveStream mainOutputStream;\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">void</span> PlayMusic(<span style=\"color: blue;\">string</span> name)\n        {\n            <span style=\"color: blue;\">if</span> (SettingsMgr.Instance.PlayMusic)\n            {\n                <span style=\"color: green;\">//BGMusicPlayer.URL = string.Format(\"{0}{1}\", MusicFolder, name);</span>\n\n\n                mainOutputStream = CreateInputStream(<span style=\"color: blue;\">string</span>.Format(<span style=\"color: #a31515;\">\"{0}{1}\"</span>, MusicFolder, name));\n\n                waveOutDevice = <span style=\"color: blue;\">new</span> WaveOut();\n                waveOutDevice.Init(mainOutputStream);\n                waveOutDevice.Play();\n            }\n        }\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>I just need to be able to play a looping background song and play multiple sound effects (simultaneously) for a small Logitech card game. I don't need all the other fancy stuff.</p>",
    "PostedDate": "2012-04-07T05:06:58.54-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "824238",
    "ThreadId": "351517",
    "Html": "<p>you need to make sure you call Dispose once for every call to PlayMusic</p>",
    "PostedDate": "2012-04-16T00:36:34.47-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]