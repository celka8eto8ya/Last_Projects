[
  {
    "Id": "810671",
    "ThreadId": "348692",
    "Html": "<p><br />Hello Mark!<br />Im working with midi in and midi out.<br />I see if for error, you use same port like in and out, error MIDout.Finalize() or&nbsp; MIDIin.Finalize()&nbsp;happen.<br />I asume this is caused by midi loop or something like that or some loop?<br />Some times is midiin ereor other times midiout, always if select the same port as midi in and midi out.<br /><br />The problem is Naudio show exeption window, and no matter how many time i click on abort or ignore, all is freezed and i have to kill the aplication using task manager, but some tiems cant kill and need a hard reboot, other times need wait lot of time.<br />How can prevent this happen?<br />I can add logic on the software for prevent select the same port, but i use my software for send midi to other appz, and if that appz, have midi in and midi out in same port (i use midi yoke virtual midi wire) the same happen.</p>\n<p>Also due is handled by naudio i can see in what portion of code this happen for try add and cathc this exeption at my way.<br /><br />How can make my software catch that exeption, instead leave naudio doit?<br /><br />This some kind of loop, and if this happen i need stop this happen and show some message then close the software probably, but prevent the complete freeze.<br /><br />This is a problem cna be fixed from your side?<br />I itest with midi monitor software and not see midi signal loop feedback, so is something wrong inside the library probably.<br /><br />Hoppe can helpme, is really ugly error and big problem.<br />Best regards!</p>",
    "PostedDate": "2012-03-15T00:24:30.767-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "810794",
    "ThreadId": "348692",
    "Html": "<p>you need to make sure you call Dispose() on your MidiIn and MidiOut to avoid that assertion. It is just a Debug.Assert, warning you that you didn't call Dispose</p>",
    "PostedDate": "2012-03-15T05:09:32.123-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "810946",
    "ThreadId": "348692",
    "Html": "<p>Mark run dispose&nbsp;when and where?<br /><br />I have this error inmediatly after loas appz, without send or recive midi.<br /><br />MIDIin.Finalize() happen when&nbsp;my appz&nbsp;use same port in in and out<br /><br />&nbsp;MIDout.Finalize()&nbsp;&nbsp;when midi in and out is the same on appz, where i send midi form my appz trough midiyoke virtual midi wire.<br /><br /><br />I repeat i nto send midi so where call dispose?<br /><br />I think you need take a look on this please.</p>\n<p>The only place where i call dispose is when i close my appz, and run midiin dispose and midi out dispose.<br />This error happen inmediatly after load appz without send or use midi.<br /><br /></p>",
    "PostedDate": "2012-03-15T09:32:36.947-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "810952",
    "ThreadId": "348692",
    "Html": "<p>how many times do you call new MidiIn or new MidiOut?</p>",
    "PostedDate": "2012-03-15T09:44:25.603-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "810964",
    "ThreadId": "348692",
    "Html": "<p><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\">&nbsp;</span></p>\n<p>&nbsp;</p>\n<div style=\"background-color: white; color: black;\">\n<pre>One time onload:\r\n\r\n\r\nGmidi.midiOut = <span style=\"color: blue;\">new</span> MidiOut(Gmidi.VMidiDevice);\r\n<span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiOut.Dispose();\r\nGmidi.midiIn = <span style=\"color: blue;\">new</span> MidiIn(Gmidi.IMidiDevice);\r\n<span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiIn.Dispose();\r\nGmidi.midiIn.Start();\r\n<br /><br /><br /></pre>\n<pre>Then the error happen, and i not make nothing or send midi or anything.<br />Also, using midi monitor, no any signal midi is sended.<br />I suspect this is sme kind of bug or problem requeire some workaround on the library.</pre>\n<pre>Like always, thankyou so much for send a fatser repply : )</pre>\n<pre>Hoppe this can be fixed please.<br /><br /></pre>\n</div>",
    "PostedDate": "2012-03-15T09:54:15.21-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "811254",
    "ThreadId": "348692",
    "Html": "<p>the finalizer is called by the .NET runtime, not by NAudio. If you are seeing it, it means that there is a way your midiOut or midiIn is losing its reference. Is there anywhere in your code that sets Gmidi.midiOut = null, or Gmidi.midiIn = null?</p>\r\n<p>Also, have a look at the NAudioDemo which does not have this problem.</p>",
    "PostedDate": "2012-03-15T23:58:47.357-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "811562",
    "ThreadId": "348692",
    "Html": "<p>Ultra srange no any call to Gmidi.midiOut = null, or Gmidi.midiIn = null?<br /><br />I cant compile the demo for see, tonz of errors.<br />Anyway i take a look and if cnat solve i make simple example and upload so you can see what im doing. : )<br />I think be the best way to not run this in a tonz of answers and questions and save your time : )<br />I back soon with some news.<br /><br />Thankyou for your support!</p>",
    "PostedDate": "2012-03-16T10:36:14.69-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "823003",
    "ThreadId": "348692",
    "Html": "<p>Check this:<br /><br />Instead run onload window I run this inside the constructor:<br />Gmidi.midiOut = <span style=\"color: blue;\">new</span> MidiOut(Gmidi.VMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiOut.Dispose();<br />Gmidi.midiIn = <span style=\"color: blue;\">new</span> MidiIn(Gmidi.IMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiIn.Dispose();<br />Gmidi.midiIn.Start();<br /><br /><br /><br /><br />Line report the error is Gmidi.midiOut = <span style=\"color: blue;\">new</span> MidiOut(Gmidi.VMidiDevice);</p>\n<p>&nbsp;</p>\n<p>From my appz, I send midi to other software, if in software where&nbsp;i send MIDI, midi out and midi in is configured to same midi device port, this happen.</p>\n<p><br /><br />If I run this on onload<br />Gmidi.midiOut = <span style=\"color: blue;\">new</span> MidiOut(Gmidi.VMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiOut.Dispose();<br />Gmidi.midiIn = <span style=\"color: blue;\">new</span> MidiIn(Gmidi.IMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiIn.Dispose();<br />Gmidi.midiIn.Start();<br /><br /><br />Complete visual studio crash.<br /><br /><br /><br />NAudio.MmException was unhandled<br />&nbsp; HResult=-2146233088<br />&nbsp; Message=UnspecifiedError calling midiOutOpen<br />&nbsp; Source=NAudio<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at NAudio.MmException.Try(MmResult result, String function)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at NAudio.Midi.MidiOut..ctor(Int32 deviceNo)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at window2.Window2..ctor() in window2.xaml.cs:line 161<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MainWindow.timer_surface1(Object sender, EventArgs args) in MainWindow.xaml.cs:line 829<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherTimer.FireTick(Object unused)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherOperation operation, CancellationToken cancellationToken, TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunInternal(Window window)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run(Window window)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at App.Main() in App.g.cs:line 0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br />&nbsp; InnerException:</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>If I setup the same midi device in out on my&nbsp;software the error is generated by:<br /><br /><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">Gmidi</span></span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">.midiIn = </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">new</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">MidiIn</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">(</span></span><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">Gmidi</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">.IMidiDevice);</span></span></p>\n<p>An this is the error:<br /><br />NAudio.MmException was unhandled<br />&nbsp; HResult=-2146233088<br />&nbsp; Message=UnspecifiedError calling midiInOpen<br />&nbsp; Source=NAudio<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at NAudio.MmException.Try(MmResult result, String function)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at NAudio.Midi.MidiIn..ctor(Int32 deviceNo)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at window2.Window2..ctor() in windows2.xaml.cs:line 162<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MainWindow.timer_surface1(Object sender, EventArgs args) in MainWindow.xaml.cs:line 829<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherTimer.FireTick(Object unused)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherOperation operation, CancellationToken cancellationToken, TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunInternal(Window window)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run(Window window)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at App.Main() in App.g.cs:line 0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br />&nbsp; InnerException:</p>\n<p>&nbsp;</p>\n<p>One comment, my software use 2 windows, one is secreen for setup midi device, the other is the software screen and one class where I have inside all things I need access form that 2 windows.<br />The windows are separate project.<br />On main Mianwindow I have a combobox for &nbsp;select midi devices.<br /><br />The structure of my projets is:<br />One class where I have inside all things need be accessed by othee windows, example:<br /><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></span></span></span></span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">NAudio.Midi;</span></span><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>\n<p><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">public</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">static</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">MidiIn </span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">midiIn;<span style=\"font-size: x-small; font-family: Consolas;\"> <br /></span></span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">public</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">static</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">MidiOut</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"> <span style=\"font-size: x-small; font-family: Consolas;\">midiOut;<span style=\"font-size: x-small; font-family: Consolas;\"> <br /></span></span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">public</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">static</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">int </span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">VMidiDevice;<span style=\"font-size: x-small; font-family: Consolas;\"> <br /></span></span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">public</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">static</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">int</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"> <span style=\"font-size: x-small; font-family: Consolas;\">IMidiDevice;<br /><br />Other class for handle swtch form one windows to other.<br /></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">The mainwindow where I have insidecombobox selector for select midi device. i call of course </span></span></span></span></span></span></span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">using </span></span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">NAudio.Midi;&nbsp; and have referenced the library.<br /><br /><br /><br />window2&nbsp; is the screen where have all features of software I call i call of course <span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">using </span></span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">NAudio.Midi;&nbsp; and have referenced the library.</span></span></span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\">&nbsp;</span></span></span></p>\n<p>InitializeComponent();</p>\n<p><br />Gmidi.midiOut = <span style=\"color: blue;\">new</span> MidiOut(Gmidi.VMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiOut.Dispose();<br />Gmidi.midiIn = <span style=\"color: blue;\">new</span> MidiIn(Gmidi.IMidiDevice);<br /><span style=\"color: blue;\">this</span>.Closed += (o, s) =&gt; Gmidi.midiIn.Dispose();<br />Gmidi.midiIn.Start();<br /><br /><br />Here is where error happen, but only if in my software I set same midi device for in and out, also same happen when&nbsp; in software where I send midi midi in and midi out is configured to same device (same midi port)</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n</span></span></span></span></span></span></p>\n<p><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">public</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\"><span style=\"font-size: x-small; font-family: Consolas; color: #0000ff;\">class</span></span></span><span style=\"font-size: x-small; font-family: Consolas;\"><span style=\"font-size: x-small; font-family: Consolas;\"> </span></span><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\"><span style=\"font-size: x-small; font-family: Consolas; color: #2b91af;\">Gmidi</span></span></span></p>\n<p>{</p>",
    "PostedDate": "2012-04-12T10:01:48.66-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "823214",
    "ThreadId": "348692",
    "Html": "<p>edited.</p>\n<p>&nbsp;</p>",
    "PostedDate": "2012-04-12T19:50:19.933-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "823868",
    "ThreadId": "348692",
    "Html": "<p><br /><br /><br /></p>\n<p>try</p>\n<p>{<br />Gmidi.midiOut = new MidiOut(Gmidi.VMidiDevice);<br />this.Closed += (o, s) =&gt; Gmidi.midiOut.Dispose();<br />Gmidi.midiIn = new MidiIn(Gmidi.IMidiDevice);<br />this.Closed += (o, s) =&gt; Gmidi.midiIn.Dispose();<br />Gmidi.midiIn.Start();</p>\n<p>}</p>\n<p>catch</p>\n<p>{</p>\n<p>MessageBox.Show(\"here message about midi errorbla bla bla.\" );<br /><span class=\"typ\">Debug</span><span class=\"pun\">.</span><span class=\"typ\">Listeners</span><span class=\"pun\">.</span><span class=\"typ\">Clear</span><span class=\"pun\">();</span><span class=\"pln\"><br /></span>Application.Current.Shutdown();</p>\n<p>}<br /><br />This is a workaround, but no idea why this happen.<br /><br /></p>",
    "PostedDate": "2012-04-14T10:11:26.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "824380",
    "ThreadId": "348692",
    "Html": "<p>before calling new MidiOut or new MidiIn, you must first Dispose of any old one.</p>\r\n<p>e.g</p>\r\n<p>&nbsp;</p>\r\n<p>if (Gmidi.midiOut != null)</p>\r\n<p>&nbsp;&nbsp;&nbsp; Gmidi.midiOut.Dispose();</p>",
    "PostedDate": "2012-04-16T06:28:37.73-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]