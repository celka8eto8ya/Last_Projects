[
  {
    "Id": "1326986",
    "ThreadId": "573425",
    "Html": "Hi,\r<br />\n<br />\nI am not very much experienced in audio programming but very much attracted with NAudio,Basically what i wanted to do is, capture the data (byte[]) from the microphone, then transport it over the network and play on client end. Just as voice call in chat application.\r<br />\nI tried saving the byte array in to the queue and send it to the service in certain interval.\r<br />\n<br />\nlong count = 0;<br />\n<pre><code>    bool bufferfull = false;\n    private WaveIn waveIn = null;\n    private BufferedWaveProvider waveProvider = null;\n    private WaveOut waveOut = null;\n    private Queue&lt;byte[]&gt; datas = new Queue&lt;byte[]&gt;();\n</code></pre>\n\nprivate void button1_Click(object sender, EventArgs e)<br />\n<pre><code>    {\n        if (waveIn != null)\n            return;\n        waveIn = new WaveIn(this.Handle);\n        waveIn.BufferMilliseconds = 25;\n        waveIn.RecordingStopped += waveIn_RecordingStopped;\n        waveIn.DataAvailable += waveIn_DataAvailable;\n\n        waveProvider = new BufferedWaveProvider(waveIn.WaveFormat);\n\n        waveOut = new WaveOut();\n        waveOut.DesiredLatency = 100;\n        waveOut.Init(waveProvider);\n        waveOut.PlaybackStopped += wavePlayer_PlaybackStopped;\n\n\n        waveIn.StartRecording();\n        waveOut.Play();\n    }</code></pre>\n\nvoid waveIn_DataAvailable(object sender, WaveInEventArgs e)<br />\n<pre><code>    {\n        // add received data to waveProvider buffer\n        if (count &lt;= 200)\n        {\n            if (waveProvider != null)\n                waveProvider.AddSamples(e.Buffer, 0, e.BytesRecorded);\n        }\n        if (count &gt;= 200)\n        {\n            //send the byte array (Queue) as stream in to the network.\n        }\n        if (!bufferfull)\n            datas.Enqueue(e.Buffer);\n        count++;\n    }\n</code></pre>\n\nand in the client side\r<br />\n<br />\ndatas = getTheQueueFromTheService();\r<br />\nwhile (datas.Count &gt; 0)<br />\n<pre><code>        {\n            var playingData = datas.Dequeue();\n            waveProvider.AddSamples(playingData, 0,playingData.Length);\n            Thread.Sleep(30);\n            waveOut.Play();\n            waveProvider.ClearBuffer();// because i got the exception Buffer full\n        }</code></pre>\n\nbut i found no luck. I googled for more the 3days, tried various methods still i was not able to figure out how to do it.\r<br />\n<br />\nWith the great hope for the assistance and help i have posted it here.I would be very greatful if some one could get me a piece of code.\r<br />\nand can i use NAudio to develop app as voice call provided by chat application.Is it appropriate.\r<br />\n<br />\nThank in advance.<br />\n",
    "PostedDate": "2014-11-28T03:55:50.393-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1327023",
    "ThreadId": "573425",
    "Html": "Hello,<br />\n<br />\nabove code seems to be correct at a first view, but this<br />\n<blockquote>\n<pre><code>    if (waveIn != null)\n     return;\n</code></pre>\n\n</blockquote>\ncould be the problem perhaps? Perhaps you could upload full project sample somewhere, so that ppl can test it for improvements.<br />\nI´d try to help you more, but I´m really busy atm with my job.<br />\n<br />\nKind regards<br />\n<br />\nFreefall<br />\n<br />\nEdit:<br />\n<br />\nThis could also be a error source as it does nothing when your buffer is full:<br />\n<blockquote>\n<pre><code>  if (count &gt;= 200)\n   {\n       //send the byte array (Queue) as stream in to the network.\n   }</code></pre>\n\n</blockquote>\n",
    "PostedDate": "2014-11-28T05:51:48.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]