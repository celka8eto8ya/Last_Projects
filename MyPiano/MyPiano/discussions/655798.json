[
  {
    "Id": "1477011",
    "ThreadId": "655798",
    "Html": "I read in a .wav of 8bit/22050Hz form, and want to resample it. (this is a UWP). From the articles by the author I should be using the WdlResamplingSampleProvider.  As a first test I made it resample to the same rate to have something to compare it with.\r<br />\n<br />\nBut something isn't right.  I used WaveStream reader to read the .wav file to a byte array, and it is correct. The size, the data, its fine.  But after using the resampler, its resulting float array[] is all zeros.  Additionally, the bits per sample is listed as 32 even though the source file is 8. (see pics).\r<br />\n<br />\nSo I am hunting for the correct way to resample and see the results or a work around. \r<br />\nThanks<br />\n<pre><code>private WaveStream reader;\nprivate IRandomAccessStream selectedStream;\nbyte[] wavByteArray;    \n\nasync void Conversion()\n{\n    using (var stream = await file.OpenAsync(FileAccessMode.Read))\n    {\n        if (stream == null) return;\n        this.selectedStream = stream;\n        CreateReader();\n        wavByteArray = new byte[reader.Length];\n        var result = reader.Read(wavByteArray, 0, (int)reader.Length);\n    }\n    var resampler = new WdlResamplingSampleProvider(reader.ToSampleProvider(), 22050);\n    float[] floatArray = new float[reader.Length];\n    var result = resampler.Read(floatArray, 0, (int)reader.Length);\n}</code></pre>\n\npictures of the code running\r<br />\n<a href=\"https://1drv.ms/f/s!Apomoggzevs3hJdrjxg25gFwyzdZ2A\" rel=\"nofollow\">https://1drv.ms/f/s!Apomoggzevs3hJdrjxg25gFwyzdZ2A</a><br />\n",
    "PostedDate": "2016-06-22T08:16:09.56-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1477267",
    "ThreadId": "655798",
    "Html": "WDLResampler works exclusively with floating point samples.  So ToSampleProvider is resampling. I would also recommend resampling in small chunks, say 1 second of audio at a time, rather than one gigantic call to read. <br />\n",
    "PostedDate": "2016-06-25T08:53:07.087-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1477381",
    "ThreadId": "655798",
    "Html": "\r\n<div>\r\n<p><span style=\"font-size:14.0pt; font-family:\">Thanks Mark,</span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\">You are saying that my reader.ToSampleProvider() won’t work because it will provide the WDLR only 8-bit byte samples and not floats?</span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\">Should I take the 8-bit byte array, cast it to float, then somehow turn that back into an ISampleSource? Not sure how to do that exactly.</span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<div>\r\n<div style=\"border:none; border-top:solid #E1E1E1 1.0pt; padding:3.0pt 0in 0in 0in\">\r\n<p><b><span style=\"font-size:11.0pt; font-family:\"></span></b></p>\r\n</div>\r\n</div>\r\n</div>\r\n",
    "PostedDate": "2016-06-27T13:05:34.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1477390",
    "ThreadId": "655798",
    "Html": "sorry, my reply was confusing. ToSampleProvider should turn your incoming audio into 32 bit floating point samples, which should be fine. I still recommend resampling in much smaller blocks.<br />\n",
    "PostedDate": "2016-06-27T14:00:26.6-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1477782",
    "ThreadId": "655798",
    "Html": "\r\n<div>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Gosh, Mark, </span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">I tried breaking it up into more discrete steps to see where things go wrong. In the code below, neither wavFloatArray ends up with any resampled data. Both output arrays end up 2000 entries long filled with all\r\n zeros. If I execute reader.Read(..) I get the source file contents at 22050, 8-bit filled with data. But it’s not resampled, and not 32bit.\r\n</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">If I set a break and look at the contents of the ISampleProvider isp, it says waveFormat.bitspersample= 32bit (like you said, resampled from 8 bits to 32) 22kHz(original sample rate), but the sourceBuffer[] is\r\n all zeros except the first entry. And the buffer array size looks peculiar. The 22/8 array is 13235bytes, while the blank isp buffer is 5516. I might have expected 13k/4, but not that.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">So basically, still can’t get from that to any other sample rate.</span></p>\r\n<p><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:#2B91AF; background:white\">ISampleProvider</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n isp = </span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">new</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:#2B91AF; background:white\">Pcm8BitToSampleProvider</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">(reader);</span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">var</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n resampler1 = </span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">new</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:#2B91AF; background:white\">WdlResamplingSampleProvider</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">(isp, 8000);</span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">wavFloatArray =\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">new</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">float</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">[2000];</span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">var</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n result = resampler1.Read(wavFloatArray, 0, 2000);</span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">var</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n resampler2 = </span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">new</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:#2B91AF; background:white\">WdlResamplingSampleProvider</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">(reader.ToSampleProvider(), 8000);</span></p>\r\n<p style=\"text-autospace:none\"><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">float</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">[]\r\n wavFloatArray2 = </span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">new</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n</span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">float</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">[2000];</span></p>\r\n<p><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\"></span><span style=\"font-size:9.5pt; font-family:Consolas; color:blue; background:white\">var</span><span style=\"font-size:9.5pt; font-family:Consolas; color:black; background:white\">\r\n result2 = resampler2.Read(wavFloatArray2, 0, 2000);</span><span style=\"font-size:14.0pt; font-family:\"></span></p>\r\n<p><a name=\"_MailEndCompose\"><span style=\"font-size:14.0pt; font-family:\"></span></a></p>\r\n<span style=\"\"></span>\r\n<div>\r\n<div style=\"border:none; border-top:solid #E1E1E1 1.0pt; padding:3.0pt 0in 0in 0in\">\r\n<p><b><span style=\"font-size:11.0pt; font-family:\"></span></b></p>\r\n</div>\r\n</div>\r\n</div>\r\n",
    "PostedDate": "2016-06-30T12:06:54.233-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]