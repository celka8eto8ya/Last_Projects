[
  {
    "Id": "542825",
    "ThreadId": "240178",
    "Html": "\r\n<p>I am trying to load wav file to stream then i want to write that byte data to file and then i want to read that file and play it,</p>\r\n<p>but when before writing to file i need to take to buffer, when i am trying to load it to buffer my computer become hang, my code is given below:</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></p>\r\n<p>&nbsp;</p>\r\n</span></span></span>\r\n<p></p>\r\n<p><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveStream</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n wavReader = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveFileReader</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">(fileName);<span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span></span></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveStream</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n pcmStream = </span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveFormatConversionStream</span></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">.CreatePcmStream(wavReader);<span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span></span></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">&nbsp;</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveStream</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n blockAlignedStream = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">BlockAlignReductionStream</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">(pcmStream);<span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span></span></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveChannel32</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n waveChannel = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveChannel32</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">(blockAlignedStream);<span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><font face=\"Consolas\" size=\"2\"></p>\r\n<p></p>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<p></p>\r\n</font></span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveFormat</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n format = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">WaveFormat</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">(waveChannel.WaveFormat.SampleRate, waveChannel.WaveFormat.BitsPerSample, waveChannel.WaveFormat.Channels);<font face=\"Consolas\" size=\"2\">\r\n</font></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span></span></span>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><font face=\"Consolas\" size=\"2\"></p>\r\n<p></p>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">byte</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">[]\r\n buffer1 = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">byte</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">[waveChannel.WaveFormat.SampleRate];<font face=\"Consolas\" size=\"2\">\r\n</font></span></span></p>\r\n<p></p>\r\n<p></p>\r\n</font></span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">BufferedWaveProvider</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n inputProvider = </span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">new</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\">BufferedWaveProvider</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">(waveChannel.WaveFormat);<span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><font face=\"Consolas\" size=\"2\">\r\n<p></p>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<p></p>\r\n</font></span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">int</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">bytesRead;<span style=\"font-family:Consolas; font-size:x-small\">\r\n</span></span></span></span></span></span></span></span></span></span></span></span>\r\n<p></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">for</span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">\r\n (</span></span><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\">int</span></span></span><span style=\"font-family:Consolas; font-size:x-small\">\r\n<span style=\"font-family:Consolas; font-size:x-small\">i = 0; i &lt;waveChannel.Length; i&#43;&#43;) {</span></span></p>\r\n<p></p>\r\n<p>&nbsp;&nbsp; bytesRead = waveChannel.Read(buffer1, 0, waveChannel.WaveFormat.SampleRate);</p>\r\n<p>&nbsp;&nbsp;&nbsp; inputProvider.AddSamples(buffer1, 0, bytesRead);</p>\r\n<p>}</p>\r\n<p>waveOutDevice.Init(inputProvider);</p>\r\n<p>waveOutDevice.Play();</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span>///end of code</p>\r\n<p></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"></span>my logic is if I can play the inputProvider which is created from bytesRead,buffer1,&nbsp;and if&nbsp;I&nbsp;will be able to write the value of bytesRead,buffer1 to a file then&nbsp; I</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">&#65279;</span></span>will be able to read these values from file and play it by inputProvider.</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">&#65279;</span></span>in this example I tested by&nbsp; files which length is 1-2sec. my computer becomes hang when it is in for loop</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">&#65279;</span></span>I also increase the value of</p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">MaxQueuedBuffers\r\n</span></span></p>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">in the\r\n</span><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"><span style=\"font-family:Consolas; color:#2b91af; font-size:x-small\"></span></span></span></span></p>\r\n<p></p>\r\n<p>BufferedWaveProvider class</p>\r\n<p></p>\r\n<p></p>\r\n",
    "PostedDate": "2011-01-02T00:50:14.053-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "542844",
    "ThreadId": "240178",
    "Html": "\r\n<p>your for loop is going round far too many times.</p>\r\n<p>try a while (waveChannel.Position &lt; waveChannel.Length) instead</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2011-01-02T04:31:44.037-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "542875",
    "ThreadId": "240178",
    "Html": "\r\n<p>Thanks.</p>\r\n<p>Thank u very much. its working now,</p>\r\n",
    "PostedDate": "2011-01-02T08:05:21.807-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "542920",
    "ThreadId": "240178",
    "Html": "\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&nbsp;</pre>\r\n<pre><p>Now I have another problem. I can write buffer data to file. code as follow:</p><p>&nbsp;</p></pre>\r\n<pre>WaveFormat format = <span style=\"color:blue\">new</span> WaveFormat(waveChannel.WaveFormat.SampleRate, waveChannel.WaveFormat.BitsPerSample, waveChannel.WaveFormat.Channels);\r\n            BufferedWaveProvider inputProvider = <span style=\"color:blue\">new</span> BufferedWaveProvider(waveChannel.WaveFormat);\r\n            <span style=\"color:blue\">byte</span>[] buffer1 = <span style=\"color:blue\">new</span> <span style=\"color:blue\">byte</span>[waveChannel.WaveFormat.SampleRate];\r\n            <span style=\"color:blue\">int</span> bytesRead;\r\n            FileStream fs = <span style=\"color:blue\">new</span> FileStream(<span style=\"color:#a31515\">&quot;c1.txt&quot;</span>, FileMode.CreateNew);\r\n            <span style=\"color:green\">// Create the writer for data.</span>\r\n            BinaryWriter w = <span style=\"color:blue\">new</span> BinaryWriter(fs);\r\n            <span style=\"color:green\">// Write data</span>\r\n            <span style=\"color:blue\">while</span> (waveChannel.Position &lt; waveChannel.Length)\r\n            {\r\n                bytesRead = waveChannel.Read(buffer1, 0, waveChannel.WaveFormat.SampleRate);\r\n                w.Write((<span style=\"color:blue\">int</span>)bytesRead);\r\n                <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> j = 0; j &lt; 4800; j&#43;&#43;)\r\n                    w.Write((<span style=\"color:blue\">int</span>)buffer1[j]);\r\n                inputProvider.AddSamples(buffer1, 0, bytesRead);\r\n            }\r\n            w.Close();\r\n            fs.Close();\r\n            waveOutDevice.Init(inputProvider);\r\n            waveOutDevice.Play();\r\n            waveChannel.Dispose();\r\n            blockAlignedStream.Dispose();\r\n            pcmStream.Dispose();\r\n            wavReader.Dispose();\r\n</pre>\r\n</div>\r\n<p><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\">&nbsp;</span></span>&nbsp;But\r\n I can't play that audio from reading byte data from that file. I can't understand how to start. Please Help</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-01-02T11:03:23.597-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "543630",
    "ThreadId": "240178",
    "Html": "\r\n<p>your best bet is to use the WaveFileWriter class to make a WAV file</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2011-01-04T03:38:31.283-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]