[
  {
    "Id": "549856",
    "ThreadId": "241910",
    "Html": "\r\n<p>Hi , I try to save the input stream without wav-headers and metadata into a binary file and after save these bytes from this file as a wav-file</p>\r\n<p>I use the following code</p>\r\n<p>public partial class Form1 : Form<br>\r\n{<br>\r\nWaveIn waveIn;<br>\r\nFileStream fs;<br>\r\nRawSourceWaveStream rsv;<br>\r\nWaveFileReader wfr;<br>\r\nBinaryWriter bw;<br>\r\n<br>\r\nprivate void button1_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nwaveIn = new WaveIn();<br>\r\nwaveIn.WaveFormat = new WaveFormat(8000, 16, 1);<br>\r\nfs = new FileStream(&quot;D:\\\\some_file.ddd&quot;, FileMode.OpenOrCreate);<br>\r\nwaveIn.DeviceNumber = 0;<br>\r\nwaveIn.DataAvailable &#43;= waveIn_DataAvailable;<br>\r\nwaveIn.RecordingStopped &#43;= new EventHandler(waveIn_RecordingStopped);<br>\r\nbw = new BinaryWriter(fs);<br>\r\nMessageBox.Show(&quot;Start Recording&quot;);<br>\r\nwaveIn.StartRecording();<br>\r\n}<br>\r\n//Write bytes by BinaryWriter<br>\r\nvoid waveIn_DataAvailable(object sender, WaveInEventArgs e)<br>\r\n{ <br>\r\n<br>\r\nbw.Write(e.Buffer, 0, e.BytesRecorded); <br>\r\n}<br>\r\n<br>\r\nprivate void button2_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nif (waveIn != null)<br>\r\n{<br>\r\nStopRecording();<br>\r\n}<br>\r\n}<br>\r\n<br>\r\nprivate void StopRecording()<br>\r\n{<br>\r\nwaveIn.StopRecording();<br>\r\n<br>\r\nMessageBox.Show(&quot;StopRecording&quot;); <br>\r\n}<br>\r\n<br>\r\nprivate void waveIn_RecordingStopped(object sender, EventArgs e)<br>\r\n{<br>\r\nif (bw != null)<br>\r\n{<br>\r\nbw.Dispose();<br>\r\nbw = null;<br>\r\n}<br>\r\nwaveIn.Dispose();<br>\r\nwaveIn = null;<br>\r\nfs.Close();<br>\r\n}<br>\r\n//Convert bytes to wav-file<br>\r\nprivate void button3_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nfs = new FileStream(&quot;D:\\\\some_file.ddd&quot;, FileMode.OpenOrCreate);<br>\r\nWaveFormat waveFormat = WaveFormat.CreateMuLawFormat(8000, 1);<br>\r\nRawSourceWaveStream reader = new RawSourceWaveStream(fs, waveFormat);<br>\r\nusing (WaveStream convertedStream = WaveFormatConversionStream.CreatePcmStream(reader))<br>\r\n{<br>\r\nWaveFileWriter.CreateWaveFile(@&quot;D:\\ddd.wav&quot;, convertedStream);<br>\r\n}<br>\r\n}</p>\r\n<p>But finally I get some terrible sound and wav-file usually twice more then original recording length. What should I do?</p>\r\n<div id=\"x__mcePaste\" style=\"left:-10000px; top:0px; width:1px; height:1px; overflow-x:hidden; overflow-y:hidden\">\r\npublic partial class Form1 : Form<br>\r\n{<br>\r\nWaveIn waveIn;<br>\r\nFileStream fs;<br>\r\nRawSourceWaveStream rsv;<br>\r\nWaveFileReader wfr;<br>\r\nBinaryWriter bw;<br>\r\n<br>\r\nprivate void button1_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nwaveIn = new WaveIn();<br>\r\nwaveIn.WaveFormat = new WaveFormat(8000, 16, 1);<br>\r\nfs = new FileStream(&quot;D:\\\\some_file.ddd&quot;, FileMode.OpenOrCreate);<br>\r\nwaveIn.DeviceNumber = 0;<br>\r\nwaveIn.DataAvailable &#43;= waveIn_DataAvailable;<br>\r\nwaveIn.RecordingStopped &#43;= new EventHandler(waveIn_RecordingStopped);<br>\r\nbw = new BinaryWriter(fs);<br>\r\nMessageBox.Show(&quot;Start Recording&quot;);<br>\r\nwaveIn.StartRecording();<br>\r\n}<br>\r\n//Write bytes by BinaryWriter<br>\r\nvoid waveIn_DataAvailable(object sender, WaveInEventArgs e)<br>\r\n{ <br>\r\n<br>\r\nbw.Write(e.Buffer, 0, e.BytesRecorded); <br>\r\n}<br>\r\n<br>\r\nprivate void button2_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nif (waveIn != null)<br>\r\n{<br>\r\nStopRecording();<br>\r\n}<br>\r\n}<br>\r\n<br>\r\nprivate void StopRecording()<br>\r\n{<br>\r\nwaveIn.StopRecording();<br>\r\n<br>\r\nMessageBox.Show(&quot;StopRecording&quot;); <br>\r\n}<br>\r\n<br>\r\nprivate void waveIn_RecordingStopped(object sender, EventArgs e)<br>\r\n{<br>\r\nif (bw != null)<br>\r\n{<br>\r\nbw.Dispose();<br>\r\nbw = null;<br>\r\n}<br>\r\nwaveIn.Dispose();<br>\r\nwaveIn = null;<br>\r\nfs.Close();<br>\r\n}<br>\r\n//Convert bytes to wav-file<br>\r\nprivate void button3_Click(object sender, EventArgs e)<br>\r\n{<br>\r\nfs = new FileStream(&quot;D:\\\\some_file.ddd&quot;, FileMode.OpenOrCreate);<br>\r\nWaveFormat waveFormat = WaveFormat.CreateMuLawFormat(8000, 1);<br>\r\nRawSourceWaveStream reader = new RawSourceWaveStream(fs, waveFormat);<br>\r\nusing (WaveStream convertedStream = WaveFormatConversionStream.CreatePcmStream(reader))<br>\r\n{<br>\r\nWaveFileWriter.CreateWaveFile(@&quot;D:\\ddd.wav&quot;, convertedStream);<br>\r\n}<br>\r\n}</div>\r\n",
    "PostedDate": "2011-01-15T07:20:32.2-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "550444",
    "ThreadId": "241910",
    "Html": "\r\n<p>you aren't recording in mulaw format but 16 bit pcm, so you don't need the WaveFormatConversionStream and shouldn't use WaveFormat.CreateMuLawFormat</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2011-01-17T03:36:46.863-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]