[
  {
    "Id": "929563",
    "ThreadId": "400086",
    "Html": "\r\n<p>Hi Mark,</p>\r\n<p>I just wanted to say thanks again for sharing NAudio. I'm new to programming, and I'm doing it as a hobby, and to learn some stuff. I really don't know that much about c# yet, but I do see that it's similar to visual basic.</p>\r\n<p>From studying the demo you have, and looking at the tutorials that giawa has, I've managed to put together a test using VB.net</p>\r\n<p>I can open, and play a wav file, and select my asio driver. I'm using a Lynx Studio AES 16 sound card (buffer is set 512).</p>\r\n<p>When I hit stop, it stutters for a few ms. I know I'm missing something, but I can't figure out what. Am I not disposing the asio driver correctly?</p>\r\n<p>Any help would greatly be appreciated.</p>\r\n<p>Many Thanks, Wyatt</p>\r\n<p>Here's my code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Imports</span> NAudio.Wave\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> Form1\n    <span style=\"color:blue\">Private</span> wave <span style=\"color:blue\">As</span> NAudio.Wave.WaveFileReader = <span style=\"color:blue\">Nothing</span>\n    <span style=\"color:blue\">Private</span> output <span style=\"color:blue\">As</span> NAudio.Wave.AsioOut = <span style=\"color:blue\">Nothing</span>\n\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> <span style=\"color:blue\">New</span>()\n        InitializeComponent()\n        InitialiseAsioControls()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">ReadOnly</span> <span style=\"color:blue\">Property</span> SelectedDeviceName() <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>\n        <span style=\"color:blue\">Get</span>\n            <span style=\"color:blue\">Return</span> <span style=\"color:blue\">CStr</span>(comboBoxAsioDriver.SelectedItem)\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Get</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Property</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> InitialiseAsioControls()\n        <span style=\"color:green\">' Just fill the comboBox AsioDriver with available driver names</span>\n        <span style=\"color:blue\">Dim</span> asioDriverNames = AsioOut.GetDriverNames()\n        <span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> driverName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> <span style=\"color:blue\">In</span> asioDriverNames\n            comboBoxAsioDriver.Items.Add(driverName)\n        <span style=\"color:blue\">Next</span> driverName\n        comboBoxAsioDriver.SelectedIndex = 0\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> btnOpen_Click(sender <span style=\"color:blue\">As</span> System.Object, e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> btnOpen.Click\n        <span style=\"color:blue\">Dim</span> wavFile <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>\n        OpenWavFile.InitialDirectory = <span style=\"color:#a31515\">&quot;&quot;</span>\n        wavFile = OpenWavFile.ShowDialog()\n        wavFile = OpenWavFile.FileName\n        Label1.Text = wavFile\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> btnPlay_Click(sender <span style=\"color:blue\">As</span> System.Object, e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> btnPlay.Click\n        <span style=\"color:blue\">If</span> Label1.Text = <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Dim</span> wavFile <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>\n            OpenWavFile.InitialDirectory = <span style=\"color:#a31515\">&quot;&quot;</span>\n            wavFile = OpenWavFile.ShowDialog()\n            wavFile = OpenWavFile.FileName\n            Label1.Text = wavFile\n        <span style=\"color:blue\">Else</span>\n            wave = <span style=\"color:blue\">New</span> NAudio.Wave.WaveFileReader(Label1.Text)\n            output = <span style=\"color:blue\">New</span> AsioOut(comboBoxAsioDriver.Text)\n            output.Init(<span style=\"color:blue\">New</span> NAudio.Wave.WaveChannel32(wave))\n            output.Play()\n            btnPlay.Enabled = <span style=\"color:blue\">False</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> DisposeWave()\n        <span style=\"color:blue\">If</span> output <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">If</span> output.PlaybackState = NAudio.Wave.PlaybackState.Playing <span style=\"color:blue\">Then</span>\n                output.<span style=\"color:blue\">Stop</span>()\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n            output.Dispose()\n            output = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n        <span style=\"color:blue\">If</span> wave <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            wave.Dispose()\n            wave = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> btnStop_Click(sender <span style=\"color:blue\">As</span> System.Object, e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> btnStop.Click\n        DisposeWave()\n        btnPlay.Enabled = <span style=\"color:blue\">True</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span><br><br></pre>\r\n</div>\r\n",
    "PostedDate": "2012-10-19T11:48:17.27-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929596",
    "ThreadId": "400086",
    "Html": "<p>don't Dispose straight away after stop. Call output.Stop(), and then in the handler for PlaybackStopped, then you can Dispose the device. Also, please make sure you are using the very latest NAudio (there is a pre-release build up on NuGet)</p>",
    "PostedDate": "2012-10-19T12:50:16.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929628",
    "ThreadId": "400086",
    "Html": "<p>Thanks for the quick reply. Sorry for being a noob.</p>\r\n<p>Could you give me an example in the test code I have above, or do you mean where I have btnStop</p>\r\n<p>add output.stop() first? I tried this, and it still stutters. I'm still not understanding something.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> DisposeWave()\r\n        <span style=\"color: blue;\">If</span> output <span style=\"color: blue;\">IsNot</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            <span style=\"color: blue;\">If</span> output.PlaybackState = NAudio.Wave.PlaybackState.Playing <span style=\"color: blue;\">Then</span>\r\n                output.<span style=\"color: blue;\">Stop</span>()\r\n            <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n            output.Dispose()\r\n            output = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n        <span style=\"color: blue;\">If</span> wave <span style=\"color: blue;\">IsNot</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n            wave.Dispose()\r\n            wave = <span style=\"color: blue;\">Nothing</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> btnStop_Click(sender <span style=\"color: blue;\">As</span> System.Object, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> btnStop.Click\r\n        output.<span style=\"color: blue;\">Stop</span>()\r\n        DisposeWave()\r\n        btnPlay.Enabled = <span style=\"color: blue;\">True</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-10-19T14:15:48.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929629",
    "ThreadId": "400086",
    "Html": "<p>get rid of the call to output.Dispose(). The ASIO driver is not ready for it yet.</p>\r\n<p>Instead, subscribe to output.PlaybackStopped event. Then in there, call output.Dispose().</p>\r\n<p>Alternatively, only Dispose the device when you press play again or close your form</p>",
    "PostedDate": "2012-10-19T14:19:12.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929653",
    "ThreadId": "400086",
    "Html": "<p>Thanks again Mark.</p>\r\n<p>In the code above, I got rid of output.Dispose()</p>\r\n<p>I still don't understand \"Instead, subscribe to output.PlaybackStopped event.\"</p>",
    "PostedDate": "2012-10-19T15:53:52.267-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929657",
    "ThreadId": "400086",
    "Html": "<p>In addition to what Mark said, I think you will need to keep a reference to the WaveChannel32 object, so you can set .PadWithZeros , which enables the PlaybackStopped event.</p>\r\n<p>Something like this:\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">WithEvents</span> output <span style=\"color: blue;\">As</span> NAudio.Wave.AsioOut = <span style=\"color: blue;\">Nothing</span>\r\n<span style=\"color: blue;\">Private</span> mainOutputStream <span style=\"color: blue;\">As</span> WaveChannel32\r\n... \r\nmainOutputStream = <span style=\"color: blue;\">New</span> WaveChannel32(wave) <span style=\"color: green;\">' tie the file reader to the output stream </span>\r\nmainOutputStream.PadWithZeroes = <span style=\"color: blue;\">False</span> <span style=\"color: green;\">' need this to detect eof</span>\r\noutput.Init(mainOutputStream) <span style=\"color: green;\">' tie output stream to output device</span>\r\n...\r\n\r\n<span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> PlaybackStopped(sender <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Object</span>, e <span style=\"color: blue;\">As</span> System.EventArgs) <span style=\"color: blue;\">Handles</span> output.PlaybackStopped\r\n        <span style=\"color: green;\">' dispose</span>\r\n<span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-10-19T16:02:56.603-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "929822",
    "ThreadId": "400086",
    "Html": "<p>Thanks again for your help Mark, and eejake52.</p>\r\n<p>Looks like I need to start over, or something. I never did get it to work right. No matter what I've tried, it still stutters when I hit the stop button.</p>\r\n<p>I'll still keep trying.</p>\r\n<p>Thanks, Wyatt</p>",
    "PostedDate": "2012-10-20T09:43:00.093-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "930053",
    "ThreadId": "400086",
    "Html": "<p>If you use the NAudioDemo application, can you play and stop ASIO without it stuttering?</p>",
    "PostedDate": "2012-10-21T09:21:03.577-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "930716",
    "ThreadId": "400086",
    "Html": "\r\n<p>Hi Mark.</p>\r\n<p>Yes, when I load the demo &quot;AsioDirectDemo&quot; and stop, there is no stutter. I used the code from that demo in a new test. and converted that into vb.net, but it stutters.</p>\r\n<p>Sorry again for be such a noob at this. Maybe it's something I'm not converting right?</p>\r\n<p>Here's the converted code from that panel. I put the panel controls on a form, and used the converted code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Imports</span> NAudio.Wave\n\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> Form1\n    <span style=\"color:blue\">Private</span> reader <span style=\"color:blue\">As</span> WaveFileReader\n    <span style=\"color:blue\">Private</span> asioOut <span style=\"color:blue\">As</span> AsioOut\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> <span style=\"color:blue\">New</span>()\n        InitializeComponent()\n        <span style=\"color:blue\">AddHandler</span> Disposed, <span style=\"color:blue\">AddressOf</span> AsioDirectPanel_Disposed\n        <span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> device <span style=\"color:blue\">In</span> AsioOut.GetDriverNames()\n            <span style=\"color:blue\">Me</span>.comboBoxAsioDevice.Items.Add(device)\n        <span style=\"color:blue\">Next</span> device\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Me</span>.comboBoxAsioDevice.Items.<span style=\"color:blue\">Count</span> &gt; 0 <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.comboBoxAsioDevice.SelectedIndex = 0\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> AsioDirectPanel_Disposed(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> EventArgs)\n        Cleanup()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Cleanup()\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Me</span>.asioOut <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.asioOut.Dispose()\n            <span style=\"color:blue\">Me</span>.asioOut = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Me</span>.reader <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.reader.Dispose()\n            <span style=\"color:blue\">Me</span>.reader = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> buttonSelectFile_Click_1(sender <span style=\"color:blue\">As</span> System.Object, e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> buttonSelectFile.Click\n        Cleanup()\n        <span style=\"color:blue\">Dim</span> ofd <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> OpenFileDialog()\n        ofd.Filter = <span style=\"color:#a31515\">&quot;WAV files|*.wav&quot;</span>\n        <span style=\"color:blue\">If</span> ofd.ShowDialog() = DialogResult.OK <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.reader = <span style=\"color:blue\">New</span> WaveFileReader(ofd.FileName)\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> buttonPlay_Click(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> args <span style=\"color:blue\">As</span> EventArgs) <span style=\"color:blue\">Handles</span> buttonPlay.Click\n        <span style=\"color:blue\">Try</span>\n            Play()\n        <span style=\"color:blue\">Catch</span> e <span style=\"color:blue\">As</span> Exception\n            MessageBox.Show(e.Message)\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Function</span> GetUserSpecifiedChannelOffset() <span style=\"color:blue\">As</span> <span style=\"color:blue\">Integer</span>\n        <span style=\"color:blue\">Dim</span> channelOffset <span style=\"color:blue\">As</span> <span style=\"color:blue\">Integer</span> = 0\n        <span style=\"color:blue\">Integer</span>.TryParse(textBoxChannelOffset.Text, channelOffset)\n        <span style=\"color:blue\">Return</span> channelOffset\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> Play()\n        <span style=\"color:green\">' allow change device</span>\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Me</span>.asioOut <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">AndAlso</span> (<span style=\"color:blue\">Me</span>.asioOut.DriverName &lt;&gt; comboBoxAsioDevice.Text <span style=\"color:blue\">OrElse</span> <span style=\"color:blue\">Me</span>.asioOut.ChannelOffset &lt;&gt; GetUserSpecifiedChannelOffset()) <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.asioOut.Dispose()\n            <span style=\"color:blue\">Me</span>.asioOut = <span style=\"color:blue\">Nothing</span>\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n\n        <span style=\"color:green\">' create device if necessary</span>\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Me</span>.asioOut <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.asioOut = <span style=\"color:blue\">New</span> AsioOut(comboBoxAsioDevice.Text)\n            <span style=\"color:blue\">Me</span>.asioOut.ChannelOffset = GetUserSpecifiedChannelOffset()\n            <span style=\"color:blue\">Me</span>.asioOut.Init(<span style=\"color:blue\">Me</span>.reader)\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n\n        <span style=\"color:blue\">Me</span>.reader.Position = 0\n        <span style=\"color:blue\">Me</span>.asioOut.Play()\n        <span style=\"color:blue\">Me</span>.Timer1.Enabled = <span style=\"color:blue\">True</span>\n        SetButtonStates()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> SetButtonStates()\n        buttonPlay.Enabled = asioOut <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">AndAlso</span> asioOut.PlaybackState &lt;&gt; PlaybackState.Playing\n        buttonStop.Enabled = asioOut <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">AndAlso</span> asioOut.PlaybackState = PlaybackState.Playing\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> buttonStop_Click(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> EventArgs) <span style=\"color:blue\">Handles</span> buttonStop.Click\n        <span style=\"color:blue\">Me</span>.<span style=\"color:blue\">Stop</span>()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> [<span style=\"color:blue\">Stop</span>]()\n        <span style=\"color:blue\">Me</span>.asioOut.<span style=\"color:blue\">Stop</span>()\n        <span style=\"color:blue\">Me</span>.Timer1.Enabled = <span style=\"color:blue\">False</span>\n        SetButtonStates()\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> timer1_Tick(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> EventArgs) <span style=\"color:blue\">Handles</span> Timer1.Tick\n        <span style=\"color:blue\">If</span> asioOut <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">AndAlso</span> asioOut.PlaybackState = PlaybackState.Playing <span style=\"color:blue\">AndAlso</span> reader.Position &gt;= reader.Length <span style=\"color:blue\">Then</span>\n            <span style=\"color:blue\">Me</span>.<span style=\"color:blue\">Stop</span>()\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\n</pre>\r\n</div>\r\n",
    "PostedDate": "2012-10-22T14:46:09.073-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "930823",
    "ThreadId": "400086",
    "Html": "<p>that's strange. I'm not a VB.NET developer but I cans see anything obviously wrong there. Could it be the garbage collector kicking in? ASIO works at a very low latency, and so if the garbage collector kicks in at an inopportune moment, it can cause stuttering and there is nothing much that can be done about it.</p>",
    "PostedDate": "2012-10-22T23:23:53.707-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931265",
    "ThreadId": "400086",
    "Html": "<p>Hi Mark.</p>\r\n<p>Thanks again for your patience on this.</p>\r\n<p>I don't think that's the problem. I wish I had an example of just the Asio Direct Playback on a windows form. I'm having trouble with the panel.</p>\r\n<p>I tried to do this on a windows form in c# (basically I copied and pasted the demo code), and it builds ok, and it works, but still stutters on stop.</p>\r\n<p>This has me thinking that I'm definitely doing something wrong when I can build, and play the demo that you have with no stuttering, but when I use the same code on a form instead of a panel, it does. Hope this make sense.</p>\r\n<p>Anyway, <a href=\"http://www.wyattrice.com/naudiotest/cnaudio.zip\">here's a link</a> to my solution file. If you have a chance, could you take a look at it?</p>\r\n<p>Thanks, Wyatt</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-10-23T11:53:51.74-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931464",
    "ThreadId": "400086",
    "Html": "<p>Hi Wyatt,</p>\r\n<p>I've tried your app and I can hear the \"stutter\" you refer to. There is also some noise when I start playing again. But the same effect is in the NAudioDemo app for me, so its clearly nothing you are doing wrong. I guess there may be a bug in the way the ASIO stop code is working and perhaps some uninitialised buffers get to play out. I'll see if I can find some time to investigate.</p>\r\n<p>Mark</p>",
    "PostedDate": "2012-10-23T23:14:21.93-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931816",
    "ThreadId": "400086",
    "Html": "<p>Thanks Mark.</p>\r\n<p>I just checked the new version of NAudio from the source in which you guys were having a discussion on \"Noise in playback start\" It seems to be working correctly now. There's no stuttering now, and I also tested it out in the VB test project I had started, and it's working as well.</p>\r\n<p>Thanks, Wyatt</p>",
    "PostedDate": "2012-10-24T09:10:31.77-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931828",
    "ThreadId": "400086",
    "Html": "<p>Edit:</p>\r\n<p>I just checked again. It still stutters when I'm in visual studio, and build, and playback from there. When I close visual studio, and goto my bin debug folder, and open the app from there, it doesn't stutter.</p>",
    "PostedDate": "2012-10-24T09:25:00.21-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931836",
    "ThreadId": "400086",
    "Html": "<p>the fix I made shouldn't affect anything to do with stopping. It was fixing a problem where you heard a bit of leftover MP3 from within the decoders buffer when you started playing again. The stutter is a strange one, and might still be related to garbage collections. The ASIO API is pretty simple - you just call driver.Stop(), so it's hard to think what else could be done to fix the problem.</p>",
    "PostedDate": "2012-10-24T09:33:46.92-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]