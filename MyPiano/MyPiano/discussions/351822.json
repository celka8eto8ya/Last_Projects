[
  {
    "Id": "822068",
    "ThreadId": "351822",
    "Html": "\r\n<p>Hi NAudio-Users.</p>\r\n<p>I'm trying to access a <strong><em>server-side</em></strong> microphone in ASP.NET / C#.</p>\r\n<p>What I am planning to do:</p>\r\n<p>Either with loading the page, or with clicking on a button, a C#-function becomes active. This gets a microphone-stream, and plays it back as an output stream. So if you go to the page and click the button, you hear what I talk into the microphone.</p>\r\n<p>So that's the theory. Atm it does not work. Before I go on, I want to mention it is NOT about audio chat. Just about my microphone input being played live on the homepage. I perfectly know you use Flash or Silverlight for client-side microphone capture.</p>\r\n<p>Sound output works. I can play from a .wav-file easily, on click on the homepage. The microphone is recognized. I used Response.Write to display the microphone's device number, the product name and so on on the homepage. So the server knows the micro. No\r\n exceptions are thrown. There is no sound, but no bugs found while debugging as well.</p>\r\n<p>So I suppose there is a bug in my code. Just to mention: The device-number, here just put as 0, is correct. I tested it with other applications. The code is extremely simple and I used the NAudio-Tutorial's code from YouTube for loopback as an example, cause\r\n I'm just trying to figure out whether it works.</p>\r\n<p>Here is the code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">using</span> System;\r\n<span style=\"color:blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:blue\">using</span> System.Linq;\r\n<span style=\"color:blue\">using</span> System.Web;\r\n<span style=\"color:blue\">using</span> System.Web.UI;\r\n<span style=\"color:blue\">using</span> System.Web.UI.WebControls;\r\n\r\n\r\n\r\n<span style=\"color:blue\">using</span> NAudio.Wave;\r\n\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> _Default : System.Web.UI.Page\r\n{\r\n\r\n    <span style=\"color:blue\">private</span> NAudio.Wave.WaveIn sourceStream = <span style=\"color:blue\">null</span>;\r\n    <span style=\"color:blue\">private</span> NAudio.Wave.DirectSoundOut waveOut = <span style=\"color:blue\">null</span>;\r\n\r\n    <span style=\"color:blue\">protected</span> <span style=\"color:blue\">void</span> Page_Load(<span style=\"color:blue\">object</span> sender, EventArgs e)\r\n    {\r\n        Label1.Text = <span style=\"color:#a31515\">&quot;Seite aufgerufen&quot;</span>;\r\n\r\n    }<span style=\"color:green\">//protected void Page_Load(object sender, EventArgs e)</span>\r\n\r\n    <span style=\"color:blue\">protected</span> <span style=\"color:blue\">void</span> show(<span style=\"color:blue\">object</span> sender, EventArgs e)\r\n    {\r\n        \r\n    }\r\n\r\n    <span style=\"color:blue\">protected</span> <span style=\"color:blue\">void</span> start(<span style=\"color:blue\">object</span> sender, EventArgs e)\r\n    {\r\n        Label1.Text = <span style=\"color:#a31515\">&quot;Aufnahme gestartet&quot;</span>;\r\n\r\n        <span style=\"color:blue\">int</span> deviceNumber = 0;\r\n\r\n        sourceStream = <span style=\"color:blue\">new</span> NAudio.Wave.WaveIn();\r\n        sourceStream.DeviceNumber = deviceNumber;\r\n\r\n        sourceStream.WaveFormat = <span style=\"color:blue\">new</span> NAudio.Wave.WaveFormat(44100, NAudio.Wave.WaveIn.GetCapabilities(deviceNumber).Channels);\r\n        NAudio.Wave.WaveInProvider waveIn = <span style=\"color:blue\">new</span> NAudio.Wave.WaveInProvider(sourceStream);\r\n\r\n        waveOut = <span style=\"color:blue\">new</span> NAudio.Wave.DirectSoundOut();\r\n        waveOut.Init(waveIn);\r\n\r\n        sourceStream.StartRecording();\r\n\r\n        waveOut.Play();  \r\n\r\n    }<span style=\"color:green\">//protected void Page_Load(object sender, EventArgs e)</span>\r\n\r\n    <span style=\"color:blue\">protected</span> <span style=\"color:blue\">void</span> stop(<span style=\"color:blue\">object</span> sender, EventArgs e)\r\n    {\r\n        Label1.Text = <span style=\"color:#a31515\">&quot;Aufnahme beendet&quot;</span>;\r\n        <span style=\"color:blue\">if</span> (waveOut != <span style=\"color:blue\">null</span>)\r\n        {\r\n            waveOut.Stop();\r\n            waveOut.Dispose();\r\n            waveOut = <span style=\"color:blue\">null</span>;\r\n        }<span style=\"color:green\">//if (waveOut != null)</span>\r\n        <span style=\"color:blue\">if</span> (sourceStream != <span style=\"color:blue\">null</span>)\r\n        {\r\n            sourceStream.StopRecording();\r\n            sourceStream.Dispose();\r\n            sourceStream = <span style=\"color:blue\">null</span>;\r\n        }<span style=\"color:green\">//if (sourceStream != null)</span>\r\n    }<span style=\"color:green\">//protected void Page_Load(object sender, EventArgs e)</span>\r\n\r\n\r\n\r\n}<span style=\"color:green\">//public partial class _Default : System.Web.UI.Page</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>And the code to display the page:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"background-color:yellow\">&lt;%</span><span style=\"color:blue\">@</span> <span style=\"color:#a31515\">Page</span> <span style=\"color:red\">Title</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Startseite&quot;</span> <span style=\"color:red\">Language</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;C#&quot;</span> <span style=\"color:red\">MasterPageFile</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;~/Site.master&quot;</span> <span style=\"color:red\">AutoEventWireup</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;true&quot;</span> <span style=\"color:red\">CodeFile</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Default.aspx.cs&quot;</span> <span style=\"color:red\">Inherits</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;_Default&quot;</span> <span style=\"background-color:yellow\">%&gt;</span>\r\n\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Content</span> <span style=\"color:red\">ID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;HeaderContent&quot;</span> <span style=\"color:red\">runat</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;server&quot;</span> <span style=\"color:red\">ContentPlaceHolderID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;HeadContent&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Content</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Content</span> <span style=\"color:red\">ID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;BodyContent&quot;</span> <span style=\"color:red\">runat</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;server&quot;</span> <span style=\"color:red\">ContentPlaceHolderID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;MainContent&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">h2</span><span style=\"color:blue\">&gt;</span>\r\n        Willkommen bei ASP.NET.\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">h2</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n        Weitere Informationen zu ASP.NET finden Sie auf <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">a</span> <span style=\"color:red\">href</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;http://www.asp.net&quot;</span> <span style=\"color:red\">title</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;ASP.NET-Website&quot;</span><span style=\"color:blue\">&gt;</span>www.asp.net<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">a</span><span style=\"color:blue\">&gt;</span>.\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">a</span> <span style=\"color:red\">href</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;http://go.microsoft.com/fwlink/?LinkID=152368&quot;</span>\r\n            <span style=\"color:red\">title</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;MSDN-ASP.NET-Dokumente&quot;</span><span style=\"color:blue\">&gt;</span>Dokumentation finden Sie auch unter ASP.NET bei MSDN<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">a</span><span style=\"color:blue\">&gt;</span>.\r\n     <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n     <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Label</span> <span style=\"color:red\">ID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Label1&quot;</span> <span style=\"color:red\">runat</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;server&quot;</span> <span style=\"color:red\">Text</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Label&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Label</span><span style=\"color:blue\">&gt;</span> <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">br</span> <span style=\"color:blue\">/&gt;</span>\r\n     <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Button</span> <span style=\"color:red\">ID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Button1&quot;</span> <span style=\"color:red\">runat</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;server&quot;</span> <span style=\"color:red\">Text</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Start&quot;</span> <span style=\"color:red\">OnClick</span> <span style=\"color:blue\">=</span> <span style=\"color:blue\">&quot;start&quot;</span> <span style=\"color:blue\">/&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">br</span> <span style=\"color:blue\">/&gt;</span>\r\n     <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Button</span> <span style=\"color:red\">ID</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Button2&quot;</span> <span style=\"color:red\">runat</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;server&quot;</span> <span style=\"color:red\">Text</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Start&quot;</span> <span style=\"color:red\">OnClick</span> <span style=\"color:blue\">=</span> <span style=\"color:blue\">&quot;stop&quot;</span> <span style=\"color:blue\">/&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">br</span> <span style=\"color:blue\">/&gt;</span>\r\n\r\n     <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">asp</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">Content</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Best regards/ Thank you</p>\r\n",
    "PostedDate": "2012-04-10T10:48:49.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "828976",
    "ThreadId": "351822",
    "Html": "<p>first of all, you are playing audio on the server, not on the clients. NAudio cannot be used to play audio in the browser of the people visiting your page.</p>\r\n<p>Secondly, you can't feed WaveOut from WaveIn directly. You need to use a BufferedWaveProvider.</p>\r\n<p>Mark</p>",
    "PostedDate": "2012-04-26T09:05:03.543-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]