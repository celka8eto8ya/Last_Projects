[
  {
    "Id": "922098",
    "ThreadId": "398093",
    "Html": "\r\n<p>I am using WaveOutEvent on Windows 7, in a web application hosted by IIS. The docs say that .init should only be called once; but I don't understand why. In fact, when I tried to dispose and recreate, I ran into a roadblock. So, I have been calling init\r\n for each new file I want to play, and so far it is working fine. Can someone clarify what is the problem with reusing the instance of WaveOutEvent?</p>\r\n<p>FYI - here is the wrapper class I am using:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Imports</span> NAudio.WindowsMediaFormat\r\n\r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> WebAudio\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Shared</span> <span style=\"color:blue\">Event</span> FileDone()\r\n\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">WithEvents</span> waveOutDevice <span style=\"color:blue\">As</span> IWavePlayer\r\n    <span style=\"color:blue\">Private</span> mainOutputStream <span style=\"color:blue\">As</span> WaveChannel32\r\n    <span style=\"color:blue\">Private</span> fReader <span style=\"color:blue\">As</span> WaveStream\r\n\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> <span style=\"color:blue\">New</span>()\r\n        <span style=\"color:green\">'waveOutDevice = New WaveOut()</span>\r\n        waveOutDevice = <span style=\"color:blue\">New</span> WaveOutEvent()\r\n        <span style=\"color:green\">'waveOutDevice = New DirectSoundOut()</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Protected</span> <span style=\"color:blue\">Overrides</span> <span style=\"color:blue\">Sub</span> Finalize()                  <span style=\"color:green\">' Finalize; rarely called in web application</span>\r\n        CloseDispose()                                  <span style=\"color:green\">' Try to shutdown cleanly</span>\r\n        <span style=\"color:blue\">MyBase</span>.Finalize()\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> CloseDispose()\r\n        <span style=\"color:blue\">If</span> (mainOutputStream <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span>) <span style=\"color:blue\">Then</span>       <span style=\"color:green\">' clean up any leftover output streams</span>\r\n            mainOutputStream.Close()\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n\r\n        <span style=\"color:blue\">If</span> (waveOutDevice <span style=\"color:blue\">IsNot</span> <span style=\"color:blue\">Nothing</span>) <span style=\"color:blue\">Then</span>          <span style=\"color:green\">' clean up the waveout device</span>\r\n            waveOutDevice.Dispose()\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> PlayFile(<span style=\"color:blue\">ByRef</span> fileName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>)       <span style=\"color:green\">' play one file</span>\r\n        <span style=\"color:blue\">Dim</span> fileExt <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>\r\n        fileExt = fileName.Substring(fileName.LastIndexOf(<span style=\"color:#a31515\">&quot;.&quot;</span>c))\r\n        <span style=\"color:blue\">Select</span> <span style=\"color:blue\">Case</span> fileExt.ToLower                     <span style=\"color:green\">' pick the appropriate file reader</span>\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;.aif&quot;</span>, <span style=\"color:#a31515\">&quot;.aiff&quot;</span>\r\n                fReader = <span style=\"color:blue\">New</span> AiffFileReader(fileName)\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;.mp3&quot;</span>\r\n                fReader = <span style=\"color:blue\">New</span> Mp3FileReader(fileName)\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;.wma&quot;</span>\r\n                fReader = <span style=\"color:blue\">New</span> WMAFileReader(fileName)\r\n            <span style=\"color:blue\">Case</span> <span style=\"color:blue\">Else</span>\r\n                Debug.WriteLine(<span style=\"color:#a31515\">&quot;WebAudio: Invalid File Extension: &quot;</span> &#43; fileExt)\r\n                <span style=\"color:blue\">Return</span>\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Select</span>\r\n        mainOutputStream = <span style=\"color:blue\">New</span> WaveChannel32(fReader)       <span style=\"color:green\">' tie the file reader to the output stream</span>\r\n        mainOutputStream.PadWithZeroes = <span style=\"color:blue\">False</span>              <span style=\"color:green\">' need this to detect eof</span>\r\n        waveOutDevice.Init(mainOutputStream)                <span style=\"color:green\">' tie output stream to output device</span>\r\n        waveOutDevice.Play()\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> PauseFile()\r\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> waveOutDevice <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\r\n            <span style=\"color:blue\">If</span> waveOutDevice.PlaybackState = PlaybackState.Stopped <span style=\"color:blue\">Then</span>\r\n                <span style=\"color:blue\">Return</span>                          <span style=\"color:green\">' ignore if already stopped</span>\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n            <span style=\"color:blue\">If</span> waveOutDevice.PlaybackState = PlaybackState.Paused <span style=\"color:blue\">Then</span>\r\n                waveOutDevice.Play()\r\n            <span style=\"color:blue\">Else</span>\r\n                waveOutDevice.Pause()\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> StopFile()\r\n        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> (waveOutDevice <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span>) <span style=\"color:blue\">Then</span>\r\n            <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> (waveOutDevice.PlaybackState = PlaybackState.Stopped) <span style=\"color:blue\">Then</span>\r\n                waveOutDevice.<span style=\"color:blue\">Stop</span>()\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> waveOutDevice_PlaybackStopped(sender <span style=\"color:blue\">As</span> <span style=\"color:blue\">Object</span>, e <span style=\"color:blue\">As</span> System.EventArgs) <span style=\"color:blue\">Handles</span> waveOutDevice.PlaybackStopped\r\n        <span style=\"color:blue\">RaiseEvent</span> FileDone()\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-10-04T12:59:52.923-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "922905",
    "ThreadId": "398093",
    "Html": "<p>If you call Init twice, various things that have been initialised won't be properly disposed of. It may work, but it will leak memory.</p>",
    "PostedDate": "2012-10-06T12:54:46.67-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]