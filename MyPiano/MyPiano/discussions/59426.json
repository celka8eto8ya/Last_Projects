[
  {
    "Id": "201192",
    "ThreadId": "59426",
    "Html": "<p>Hi there!</p>\r\n<p>First of all - you're providing the coolest audio library I've seen!&nbsp; Using naudio, I've been able to make a recording function in VB.NET that really works!&nbsp; (searching on the net, you'll find that nobody else has a clear concise example)</p>\r\n<p>Now, I was wondering if there is any chance of create a function in naudio to convert waves to mp3?&nbsp; Does it already - I read that it can convert mp3s to waves.&nbsp; I ask that because my app is using windows media player.&nbsp; Media player has a speed control which works great with mp3s but not with waves.&nbsp; The waves are recorded in my app using naudio... So they're not copyrighted or anything.</p>\r\n<p>&nbsp;</p>\r\n<p>Also, how do I change the recording samplerate for the reording of a wave?&nbsp;</p>\r\n<p>is this the command to change?</p>\r\n<p>Dim recordingFormat As New WaveFormat(8000, 16, 1) - what are the 3 numbers regarding?</p>\r\n<p>I've decided to paste my VB.net code here so that vb.net users can also taste the fruits of NAudio!</p>\r\n<p>A) first go and download the naudio dll file and add it as a reference in your project!!!!&nbsp; It's completely Free!<br> http://www.codeplex.com/naudio <br> <br> also add system.data as a reference<br> <br> B) The code is was all in C# but I converted to VB code here's the code (add the buttons to you form where listed:<br> <br> You'll need 3 buttons on your form<br> <br> buttonStartRecording<br> buttonSelectOutputFile<br> buttonStopRecording<br> <br> a checkbox (checkBoxAutoPlay)<br> <br> a progressbar (progressbar1)<br> <br> a savedialog (saveFileDialog)<br> <br> and viola!&nbsp; This example records for 30 seconds before playing the wave back.&nbsp; If you want indefinit recording, get rid of<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim secondsRecorded As Integer = CInt((writer.Length / writer.WaveFormat.AverageBytesPerSecond))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If secondsRecorded &gt;= 30 Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StopRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; progressBar1.Value = secondsRecorded<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> <br> from the waveInStream_DataAvailable sub<br> <br> <br> C) I would include an extra button to change the default sound input - this will call up your recording devices<br> <br> Here's the code for that<br> <br> &nbsp;&nbsp;&nbsp; Private Sub recordDevicesBTTN_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles recordDevicesBTTN.Click<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shell(&quot;rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,1&quot;)<br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> That last number - if you change it to 0 you get the payback devices :)<br> <br> <br> <br> <br> <br> <br> Here's the code<br> <br> Imports System<br> Imports System.Collections.Generic<br> Imports System.ComponentModel<br> Imports System.Data<br> Imports System.Drawing<br> Imports System.Text<br> Imports System.Windows.Forms<br> Imports NAudio.Wave<br> Imports System.Diagnostics<br> Public Class Form1<br> <br> &nbsp;&nbsp;&nbsp; Private waveInStream As WaveInStream<br> &nbsp;&nbsp;&nbsp; Private writer As WaveFileWriter<br> &nbsp;&nbsp;&nbsp; Private outputFilename As String<br> <br> &nbsp;&nbsp;&nbsp; Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load<br> <br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> &nbsp;&nbsp;&nbsp; Private Sub buttonStartRecording_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles buttonStartRecording.Click<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If waveInStream Is Nothing Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If outputFilename Is Nothing Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buttonSelectOutputFile_Click(sender, e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If outputFilename Is Nothing Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim recordingFormat As New WaveFormat(8000, 16, 1)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; writer = New WaveFileWriter(outputFilename, recordingFormat)<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waveInStream = New WaveInStream(0, recordingFormat, Me)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler waveInStream.DataAvailable, AddressOf waveInStream_DataAvailable<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waveInStream.StartRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buttonStartRecording.Enabled = False<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> &nbsp;&nbsp;&nbsp; Private Sub waveInStream_DataAvailable(ByVal sender As Object, ByVal e As WaveInEventArgs)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; writer.WriteData(e.Buffer, 0, e.BytesRecorded)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim secondsRecorded As Integer = CInt((writer.Length / writer.WaveFormat.AverageBytesPerSecond))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If secondsRecorded &gt;= 30 Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StopRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; progressBar1.Value = secondsRecorded<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> &nbsp;&nbsp;&nbsp; Private Sub StopRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waveInStream.StopRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waveInStream.Dispose()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waveInStream = Nothing<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; writer.Close()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; writer = Nothing<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buttonStartRecording.Enabled = True<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; progressBar1.Value = 0<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If checkBoxAutoPlay.Checked Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Process.Start(outputFilename)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> &nbsp;&nbsp;&nbsp; Private Sub buttonStopRecording_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles buttonStopRecording.Click<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If waveInStream IsNot Nothing Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StopRecording()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp; End Sub<br> <br> &nbsp;&nbsp;&nbsp; Private Sub buttonSelectOutputFile_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles buttonSelectOutputFile.Click<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim saveFileDialog As New SaveFileDialog()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saveFileDialog.Title = &quot;Select output file:&quot;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saveFileDialog.Filter = &quot;WAV Files (*.wav)|*.wav&quot;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saveFileDialog.FileName = outputFilename<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If saveFileDialog.ShowDialog() = DialogResult.OK Then<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outputFilename = saveFileDialog.FileName<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br> &nbsp;&nbsp;&nbsp; End Sub<br> End Class</p>\r\n<p>&nbsp;</p>\r\n<p>Cheers,</p>\r\n<p>Sean (www.prolevelguitar.com)</p>\r\n<p><img id=kosa-target-image style=\"visibility:hidden;z-index:2147483647;left:377px;top:1480px\" alt=\"\"></p>",
    "PostedDate": "2009-06-13T11:28:57.763-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]