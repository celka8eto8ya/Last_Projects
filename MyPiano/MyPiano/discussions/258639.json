[
  {
    "Id": "616753",
    "ThreadId": "258639",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I am a beginner in c #. I have a code that is speaking, the sound output of the computer's sound card. But this code does not allow me to out the sound in a specific external sound card.I have used devicenumber but the problem is not solved yet.</p>\r\n<p>Has ANYONE can help me improve my code so that it can hear the sound listen in a particular external sound card.</p>\r\n<p><span title=\"Cliquer ici pour voir d'autres traductions\">it</span>&nbsp;<span title=\"Cliquer ici pour voir d'autres traductions\">is</span>&nbsp;<span title=\"Cliquer ici pour voir d'autres traductions\">possible to</span>&nbsp;<span title=\"Cliquer ici pour voir d'autres traductions\">call\r\n the</span>&nbsp;device<span title=\"Cliquer ici pour voir d'autres traductions\">&nbsp;in the</span>&nbsp;<span title=\"Cliquer ici pour voir d'autres traductions\">parameter</span>&nbsp;<span title=\"Cliquer ici pour voir d'autres traductions\">function:Streaming\r\n Form(int deviceNumber )and&nbsp;</span><span title=\"Cliquer ici pour voir d'autres traductions\">how????<span style=\"white-space:pre\">\r\n</span></span>&nbsp;</p>\r\n<p>Thank you in advance.</p>\r\n<p>Here is the code:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\"><br></span></pre>\r\n<pre><span style=\"color:blue\">using</span> System;\r\n<span style=\"color:blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:blue\">using</span> System.ComponentModel;\r\n<span style=\"color:blue\">using</span> System.Data;\r\n<span style=\"color:blue\">using</span> System.Drawing;\r\n<span style=\"color:blue\">using</span> System.Linq;\r\n<span style=\"color:blue\">using</span> System.Text;\r\n<span style=\"color:blue\">using</span> System.Windows.Forms;\r\n<span style=\"color:blue\">using</span> NAudio.Wave;\r\n<span style=\"color:blue\">using</span> System.Runtime.InteropServices;\r\n\r\n<span style=\"color:blue\">namespace</span> PaGa\r\n{\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> StreamingForm : Form{\r\n\r\n      \r\n\r\n\r\n        <span style=\"color:blue\">public</span> StreamingForm()\r\n             \r\n        {\r\n            InitializeComponent();\r\n            \r\n            \r\n        }\r\n         \r\n         \r\n\r\n         <span style=\"color:blue\">private</span> <span style=\"color:blue\">const</span> <span style=\"color:blue\">string</span> mmdll = <span style=\"color:#a31515\">&quot;winmm.dll&quot;</span>;\r\n         [DllImport(mmdll)]\r\n         <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">extern</span> <span style=\"color:blue\">int</span> waveOutGetNumDevs();\r\n\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:gray\">///</span><span style=\"color:green\"> Clean up any resources being used.</span>\r\n\t\t<span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;</span>\r\n\t\t\r\n\r\n\t\t<span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:gray\">///</span><span style=\"color:green\"> The main entry point for the application.</span>\r\n\t\t<span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:green\">//[STAThread]</span>\r\n\t\t\r\n\r\n\t\t<span style=\"color:blue\">private</span> PaGa.WaveOutPlayer m_Player;\r\n\t\t<span style=\"color:blue\">private</span> PaGa.WaveInRecorder m_Recorder;\r\n\t\t<span style=\"color:blue\">private</span> PaGa.FifoStream m_Fifo = <span style=\"color:blue\">new</span> PaGa.FifoStream();\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">byte</span>[] m_PlayBuffer;\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">byte</span>[] m_RecBuffer;\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> Filler(IntPtr data, <span style=\"color:blue\">int</span> size)\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">if</span> (m_PlayBuffer == <span style=\"color:blue\">null</span> || m_PlayBuffer.Length &lt; size)\r\n\t\t\t\tm_PlayBuffer = <span style=\"color:blue\">new</span> <span style=\"color:blue\">byte</span>[size];\r\n\t\t\t<span style=\"color:blue\">if</span> (m_Fifo.Length &gt;= size)\r\n\t\t\t\tm_Fifo.Read(m_PlayBuffer, 0, size);\r\n\t\t\t<span style=\"color:blue\">else</span>\r\n\t\t\t\t<span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 0; i &lt; m_PlayBuffer.Length; i&#43;&#43;)\r\n\t\t\t\t\tm_PlayBuffer[i] = 0;\r\n\t\t\tSystem.Runtime.InteropServices.Marshal.Copy(m_PlayBuffer, 0, data, size);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> DataArrived(IntPtr data, <span style=\"color:blue\">int</span> size)\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">if</span> (m_RecBuffer == <span style=\"color:blue\">null</span> || m_RecBuffer.Length &lt; size)\r\n\t\t\t\tm_RecBuffer = <span style=\"color:blue\">new</span> <span style=\"color:blue\">byte</span>[size];\r\n\t\t\tSystem.Runtime.InteropServices.Marshal.Copy(data, m_RecBuffer, 0, size);\r\n\t\t\tm_Fifo.Write(m_RecBuffer, 0, m_RecBuffer.Length);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> Stop()\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">if</span> (m_Player != <span style=\"color:blue\">null</span>)\r\n\t\t\t\t<span style=\"color:blue\">try</span>\r\n\t\t\t\t{\r\n\t\t\t\t\tm_Player.Dispose();\r\n\t\t\t\t}\r\n\t\t\t\t<span style=\"color:blue\">finally</span>\r\n\t\t\t\t{\r\n\t\t\t\t\tm_Player = <span style=\"color:blue\">null</span>;\r\n\t\t\t\t}\r\n\t\t\t<span style=\"color:blue\">if</span> (m_Recorder != <span style=\"color:blue\">null</span>)\r\n\t\t\t\t<span style=\"color:blue\">try</span>\r\n\t\t\t\t{\r\n\t\t\t\t\tm_Recorder.Dispose();\r\n\t\t\t\t}\r\n\t\t\t\t<span style=\"color:blue\">finally</span>\r\n\t\t\t\t{\r\n\t\t\t\t\tm_Recorder = <span style=\"color:blue\">null</span>;\r\n\t\t\t\t}\r\n\t\t\tm_Fifo.Flush(); <span style=\"color:green\">// clear all pending data</span>\r\n\t\t}\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> Start()\r\n\t\t{\r\n\t\t\t<span style=\"color:green\">//Stop();</span>\r\n\t\t\t<span style=\"color:green\">//try</span>\r\n\t\t\t<span style=\"color:green\">//{</span>\r\n\t\t\t\tPaGa.WaveFormatt fmt = <span style=\"color:blue\">new</span> PaGa.WaveFormatt(44100, 16, 2);\r\n\t\t\t\tm_Player = <span style=\"color:blue\">new</span> PaGa.WaveOutPlayer(-1, fmt, 16384, 3, <span style=\"color:blue\">new</span> PaGa.BufferFillEventHandler(Filler));\r\n\t\t\t\tm_Recorder = <span style=\"color:blue\">new</span> PaGa.WaveInRecorder(0, fmt, 16384, 3, <span style=\"color:blue\">new</span> PaGa.BufferDoneEventHandler(DataArrived));\r\n               <span style=\"color:green\">// wave = new WaveOut();</span>\r\n                \r\n           <span style=\"color:green\">// stop previous sounds before starting</span>\r\n           \r\n            \r\n\t\t\t<span style=\"color:green\">//}</span>\r\n\t\t\t<span style=\"color:green\">//catch</span>\r\n\t\t\t<span style=\"color:green\">//{</span>\r\n\t\t\t\t<span style=\"color:green\">//Stop();</span>\r\n\t\t\t\t<span style=\"color:green\">//throw;</span>\r\n\t\t\t<span style=\"color:green\">//}</span>\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> StreamingForm_Closing(<span style=\"color:blue\">object</span> sender, System.ComponentModel.CancelEventArgs e)\r\n\t\t{\r\n\t\t\tStop();\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> StartButton_Click(<span style=\"color:blue\">object</span> sender, System.EventArgs e)\r\n\t\t{\r\n\t\t\tStart();\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> StopButton_Click(<span style=\"color:blue\">object</span> sender, System.EventArgs e)\r\n\t\t{\r\n\t\t\tStop();\r\n\t\t}\r\n       \r\n\r\n        \r\n\r\n\r\n\t}\r\n}\r\n\r\n    \r\n\r\n</pre>\r\n</div>\r\nHello,\r\n<p></p>\r\n<p>I am a beginner in c #. I have a code that is speaking, the sound output of the computer's sound card. But this code does not allow me to out the sound in a specific external sound card.I have used devicenumber but the problem is not solved yet.</p>\r\n<p>Has ANYONE can help me improve my code so that it can hear the sound listen in a particular external sound card.\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Thank you in advance.</p>\r\n<p>Here is the code:</p>\r\n",
    "PostedDate": "2011-05-23T07:05:52.52-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "616771",
    "ThreadId": "258639",
    "Html": "<p>You do not appear to be using NAudio. If I were to guess, it would be to change the first parameter of the WaveOutPlayer constructor to be the output device number you wish to play through.</p>\r\n<p>Mark</p>",
    "PostedDate": "2011-05-23T07:29:08.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "616795",
    "ThreadId": "258639",
    "Html": "<p>&nbsp;</p>\r\n<p><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">But</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">I</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">want it</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">to be</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">in</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\"><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">&nbsp;the</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">parameter</span>&nbsp;of</span>&nbsp;\"<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">streamingForm\" &nbsp;function</span>&nbsp;&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">for</span><br /><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">can</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">call</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">this</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">function</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">to</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">the outside</span><span title=\"Cliquer ici pour voir d'autres traductions\">.</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">Do</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">you</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">can help me</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">do</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">that markheath please.</span></p>",
    "PostedDate": "2011-05-23T08:05:25.803-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "616801",
    "ThreadId": "258639",
    "Html": "<p>Just save it in a class member</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">private</span> <span style=\"color: blue;\">int</span> deviceNumber;\r\n\r\n<span style=\"color: blue;\">public</span> StreamingForm(<span style=\"color: blue;\">int</span> deviceNumber)\r\n{\r\n    <span style=\"color: blue;\">this</span>.deviceNumber = deviceNumber;\r\n    InitializeComponent();\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>then you can use it in the constructor for WaveOutPlayer further on</p>\r\n<p>Mark</p>\r\n<div id=\"_mcePaste\" class=\"mcePaste\" style=\"position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;\">\r\n<pre>        <span style=\"color: blue;\">public</span> StreamingForm()\r\n             \r\n        {\r\n            InitializeComponent();\r\n            \r\n            \r\n        }<div style=\"color: black; background-color: white;\"><pre><span style=\"color: blue;\">private</span> <span style=\"color: blue;\">int</span> deviceNumber;\r\n<span style=\"color: blue;\">public</span> StreamingForm(<span style=\"color: blue;\">int</span> deviceNumber)             \r\n{\r\n    <span style=\"color: blue;\">this</span>.deviceNumber = deviceNumber;\r\n    InitializeComponent();\r\n}\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>",
    "PostedDate": "2011-05-23T08:08:53.62-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "616813",
    "ThreadId": "258639",
    "Html": "<p>&nbsp;</p>\r\n<p><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">thank you</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">for your</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">reply</span><span title=\"Cliquer ici pour voir d'autres traductions\">.</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">I tried</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">with</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">this method</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">but the</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">sound</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">always comes out</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">of</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">the same</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">external sound card</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">if I change</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">the</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">device number.</span></p>",
    "PostedDate": "2011-05-23T08:22:55.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "616817",
    "ThreadId": "258639",
    "Html": "<p>&nbsp;</p>\r\n<div id=\"gt-res-content\" class=\"almost_half_cell\">\r\n<div dir=\"ltr\"><span id=\"result_box\" lang=\"en\"><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">I</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">think</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">it's</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">the</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">right</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">approach</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">but</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">it</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">lacks</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">something</span>&nbsp;<span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\">to make it work</span></span>\r\n<div><span class=\"hps\" title=\"Cliquer ici pour voir d'autres traductions\"><br /></span></div>\r\n</div>\r\n</div>",
    "PostedDate": "2011-05-23T08:29:43.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]